(()=>{var qs=Object.defineProperty,$s=Object.defineProperties;var Ws=Object.getOwnPropertyDescriptors;var wo=Object.getOwnPropertySymbols;var Ys=Object.prototype.hasOwnProperty,js=Object.prototype.propertyIsEnumerable;var Io=(o,e,t)=>e in o?qs(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,u=(o,e)=>{for(var t in e||(e={}))Ys.call(e,t)&&Io(o,t,e[t]);if(wo)for(var t of wo(e))js.call(e,t)&&Io(o,t,e[t]);return o},v=(o,e)=>$s(o,Ws(e));var g=(o,e,t)=>new Promise((r,n)=>{var i=d=>{try{a(t.next(d))}catch(c){n(c)}},s=d=>{try{a(t.throw(d))}catch(c){n(c)}},a=d=>d.done?r(d.value):Promise.resolve(d.value).then(i,s);a((t=t.apply(o,e)).next())});var rt,Ks=new Uint8Array(16);function Qt(){if(!rt&&(rt=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!rt))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return rt(Ks)}var _o=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Qs(o){return typeof o=="string"&&_o.test(o)}var Po=Qs;var P=[];for(ot=0;ot<256;++ot)P.push((ot+256).toString(16).substr(1));var ot;function Xs(o){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=(P[o[e+0]]+P[o[e+1]]+P[o[e+2]]+P[o[e+3]]+"-"+P[o[e+4]]+P[o[e+5]]+"-"+P[o[e+6]]+P[o[e+7]]+"-"+P[o[e+8]]+P[o[e+9]]+"-"+P[o[e+10]]+P[o[e+11]]+P[o[e+12]]+P[o[e+13]]+P[o[e+14]]+P[o[e+15]]).toLowerCase();if(!Po(t))throw TypeError("Stringified UUID is invalid");return t}var Co=Xs;function Js(o,e,t){o=o||{};var r=o.random||(o.rng||Qt)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){t=t||0;for(var n=0;n<16;++n)e[t+n]=r[n];return e}return Co(r)}var Xt=Js;var fe="3.17.3";var Oo=1e4;var Zs=4,G={GJ:1,GI:2,SB:16},Jt={[G.GJ]:"js.gsspcln.jp",[G.GI]:"js.genieessp.com",[G.SB]:"js.mediams.mb.softbank.jp"},nt="bb49897c-6ae0-4d48-8db0-c4531321096f",Zt={use:!1,pubID:nt,externalApstag:!1},Mo={use:!1,count:4,gamPolicyInterval:3e4,viewableInterval:1e4,excludeAladdin:!0};var xo=3e4,Y={OVERLAY:"1000000000",OFFERWALL:"1000001000",INTERSTITIAL:"1000001100"},ne="format is not appropriate",ie="gnhb_debug",x={DISABLED:0,ENABLED:1,OPEN_EXTERNAL:2},Lo="slotdiv",Do="cpt",Fo="cptver",No=fe,B=1400,Bo=3e3,Ho={singleRequest:!1},Uo={timeout:B,uam:Zt,mediaId:0,usePolicyChecker:!1,usePPID:!1,bidCurrency:"JPY",logTransmissionRate:10,prebid:{schainSid:"0"},isLD:!1,enableOVKindness:!1,sessionTimeout:18e4},ko={useSingleRequest:!1},j={bidder:"hb_bidder",adId:"hb_adid",pbPb:"hb_pb",size:"hb_size",source:"hb_source",format:"hb_format"},ea=[{key:j.bidder,val:function(o){return o.bidderCode}},{key:j.adId,val:function(o){return o.adId}},{key:j.pbPb,val:function(o){return o.pbCg}},{key:j.size,val:function(o){return o.size}},{key:j.source,val:function(o){return o.source}},{key:j.format,val:function(o){return o.mediaType}}],ta=[{key:"gn_size",val:function(o){return o.size}}];var Go=[...ea,...ta],er="CptExApsRequest",tr="CptExApsBidsEnd",rr="geniee_cpt_sandbox";var Vo=Zs,zo=50,or="refresh",Oe="true",qo={[or]:[Oe]},$o={"cpt-ov-rc":"1"},nr="rerun",ir="true",Wo={[nr]:[ir]},he="CptStopRepRef",Yo="CptEnableRepRef",H={PATH:"cpt.geniee.jp/hb/v1/policy-check",PATHv0:"hb.gsspcln.jp/hb/v0/count/url",POLICY:{KEYS:["geniee_type","geniee-type"],OK:"0",NG:"1"}},jo="forced_paths",ve="gninstavoid",K="geniee_interstitial",ye="gn_inst_scroll_cancel",se="gn_ow_scroll_cancel",Ko="__gn_inst_ad_info__",C="geniee_overlay_outer",U="geniee_overlay_inner",V="geniee_overlay_close",it="geniee_overlay_margin",st="geniee_overlay_boots",sr="geniee_overlay_pr_bar",at="--gn-ov-ad-height",Me="--gn-ov-before-top",xe="--gn-ov-before-bottom";var Qo="geniee_pv",Xo="atc",Jo="__iago_cpt_targeting__",ar="cpt_type",lr={DEFAULT:"default",IN_IFRAME:"in_iframe"},Zo="mini_cpt_type",dr={DIRECT:"direct",PASSBACK:"passback"},lt,en,tn,rn,Ee=(rn=(tn=window.gn_pvid)!=null?tn:(en=(lt=window.self.crypto)==null?void 0:lt.randomUUID)==null?void 0:en.call(lt))!=null?rn:Xt(),p={init:"init",reload:"reload",onRegister:"onRegister",Refresher:{permit:"Refresher.permit",prevent:"Refresher.prevent",recovery:"Refresher.recovery",afterRefresh:"Refresher.afterRefresh",requestReBid:"Refresher.requestReBid"},Requester:{requestInterstitial:"Requester.requestInterstitial"},Recoverer:{recover:"Recoverer.recover"},Bidder:{bidStart:"Bidder.bidStart",bidEnd:"Bidder.bidEnd",requestRefresh:"Bidder.requestRefresh"},Analyzer:{intervalHit:"Analyzer.intervalHit"},Aladdin:{renderEnded:"Aladdin.renderEnded"},GamRequester:{NoAd:"GamRequester.NoAd"}};var cr=o=>typeof o=="object"&&!Array.isArray(o),on=o=>JSON.parse(JSON.stringify(o)),F=(...o)=>o.map(e=>cr(e)?e:{}).reduce((e,t)=>(Object.keys(t).forEach(r=>{cr(t[r])?e[r]=e[r]?F(e[r],t[r]):t[r]:e[r]=t[r]}),e),{}),dt=(o,e=1/0)=>typeof o!="object"||Object.isFrozen(o)||e<=0?o:(Object.keys(o).forEach(t=>{o[t]=dt(o[t],e-1)}),Object.freeze(o)),ct=(o,e)=>e.min<=o&&o<=e.max,nn=o=>o?o.replace(/^\?/,"").split("&").reduce((e,t)=>{let[r,n]=t.split("=");return e[r]=n,e},{}):{};function Q(o){var t;let e=nn(window.location.search);return o?(t=e[o])!=null?t:"":e}var pr=o=>Object.entries(o).reduce((e,t)=>{let[r,n]=t;return n!=null?`${e}${String(r)}=${window.encodeURIComponent(String(n))}&`:e},"?").slice(0,-1),mr=o=>{let e=F(nn(window.location.search),o);window.location.search=pr(e)},ur=()=>Math.floor(Math.random()*parseInt("ffffff",16)).toString(16).padStart(6,"0"),pt=(o,e)=>{if(!o.length)return null;if(o.length===1)return o[0];let t=o.reduce((i,s)=>i+Number(s[e]),0);if(!t)return null;let r=Math.random()*t,n=0;for(let i=0;i<o.length;i++)if(n+=Number(o[i][e]),r<=n)return o[i];return null},sn=()=>1+Math.floor(Math.random()*100),mt=(o,e,t)=>cr(o)?Object.prototype.hasOwnProperty.call(o,t)?o:v(u({},o),{[t]:!1}):v(u({},e),{[t]:!!o}),gr=(...o)=>(o==null?void 0:o[0])?o.flat(2):null,b=()=>{};var ut=o=>typeof o!="undefined"&&o!==null,Se=(o,e,t)=>{let r=`${o}=${e};`,n=t?`expires=${t==null?void 0:t.toUTCString()};`:"";document.cookie=`${r}${n}path=/;`},gt=o=>{var e;return(e=document.cookie.split("; ").reduce((t,r)=>{let[n,i]=r.split("=");return t[n]=i,t},{})[o])!=null?e:null},an=()=>window.outerWidth,I=(o,e,t)=>{let r=e.substr(0,2)==="--"?e:"--"+e;o.style.setProperty(r,t)},ln=(o,...e)=>{e.forEach(t=>{let r=t.substr(0,2)==="--"?t:"--"+t;o.style.removeProperty(r)})},Le=(o,e)=>{let t=r=>{e(r)&&window.removeEventListener(o,t)};window.addEventListener(o,t)},X=o=>{let e=new Date;return e.setMinutes(e.getMinutes()+o),e},dn=()=>window.top!==window.self,ft=()=>{var o;try{if(!window.top)throw new Error("window.top is undefined");return window.top.location.href}catch(e){return((o=window.location)==null?void 0:o.href)||document.referrer}},ht=(o,e)=>new Promise((t,r)=>{let n=new XMLHttpRequest;n.open("GET",o,!0),n.timeout=e,n.onload=()=>{t(n.responseText)},n.ontimeout=()=>{r("Request to API timed out")},n.onerror=()=>{r("Request to API failed")},n.send()}),vt=o=>o.includes(window.location.host),cn=(o,e)=>{var n;if(!window.gnpb)return!1;let r=(n=window.gnpb.getAllWinningBids().find(i=>i.adUnitCode===o))==null?void 0:n.bidder;return e===r},pn=(o,e)=>[e.filter(t=>o(t)),e.filter(t=>!o(t))];var ra=o=>{if(o==="true")return!0;if(o==="false")return!1},mn=o=>{let e=Number(o);return isNaN(e)?void 0:e},oa=(o,e)=>{var t,r;return typeof e=="number"?(t=mn(o))!=null?t:e:typeof e=="boolean"?(r=ra(o))!=null?r:e:o},Ae=(o,e)=>({get:()=>{let i=localStorage.getItem(o);return i?oa(i,e):e},set:i=>(localStorage.setItem(o,i.toString()),i),clear:()=>{localStorage.removeItem(o)}}),un=o=>({get:()=>{let n=localStorage.getItem(o);if(!n)return;let i=mn(n);return ut(i)?new Date(i):void 0},set:n=>(localStorage.setItem(o,n.getTime().toString()),n),clear:()=>{localStorage.removeItem(o)}});var De=o=>{let{backgroundColor:e,fontColor:t}=u({backgroundColor:"#1A57A0",fontColor:"#fff"},o);return`display:inline-block;color:${t};background-color:${e};padding:1px 4px; margin-right: 2px; border-radius:3px;`},ae={blue:De({backgroundColor:"#1A57A0"}),red:De({backgroundColor:"#9e1a5c"}),purple:De({backgroundColor:"#871aa0"}),green:De({backgroundColor:"#1aa021"}),black:De({backgroundColor:"#333333"})},yt=(...o)=>{let e=[{label:"HB Wrapper",style:ae.blue},...o,{label:`${Math.floor(performance.now())}ms`,style:ae.black}],t=e.reduce((n,{label:i})=>`${n}%c${i}`,""),r=e.map(({style:n})=>n);return[t,...r]},gn=class{constructor(){this.parseMode=e=>{let t=Number(e);return(n=>Object.values(x).includes(n))(t)?t:0};this.setMode(this.getDebugMode())}log(...e){this.mode!==x.DISABLED&&console.debug(...yt({label:"INFO",style:ae.blue}),...e)}errorLog(...e){this.mode!==x.DISABLED&&console.debug(...yt({label:"ERROR",style:ae.red}),...e)}eventLog(...e){this.mode!==x.DISABLED&&console.debug(...yt({label:"EVENT",style:ae.purple}),...e)}beaconLog(e,...t){if(this.mode===x.DISABLED)return;let r="eventType"in e?e.eventType:`t:${e.t}`,n=yt({label:"BEACON",style:ae.green},{label:r,style:ae.green});console.debug(...n,...t,e)}getMode(){if(this.mode)return this.mode}setMode(e){this.mode=this.parseMode(e),this.apply()}openExternalDebugger(){var t;let e={google_console:"1",pbjs_debug:"true",[ie]:x.ENABLED.toString()};e[ie]=x.ENABLED.toString(),(t=window==null?void 0:window.apstag)==null||t.debug("enable"),mr(e)}closeExternalDebugger(){var t;this.log("reloading to close external debuggers...");let e={google_console:null,pbjs_debug:null,gnhb_debug:null};document.cookie="google_pubconsole=; path=/; expires="+new Date(Date.now()-1).toUTCString(),e[ie]=x.DISABLED.toString(),(t=window==null?void 0:window.apstag)==null||t.debug("disable"),mr(e)}apply(){switch(this.mode){case x.DISABLED:this.log("debug mode disabled");return;case x.ENABLED:this.log("debug mode enabled");return;case x.OPEN_EXTERNAL:this.log("reloading to launch external debuggers..."),this.openExternalDebugger();return;default:this.errorLog("invalid debug mode passed. debug mode disabled.",this.mode),this.mode=x.DISABLED}}getDebugMode(){let e=this.parseMode(Q(ie)),{get:t}=Ae(ie,0),r=t(),n=this.parseMode(gt(ie));return e||r||n||x.DISABLED}},l=new gn;var na={LOAD_COMPLETED:"lc",EXIT:"exit"},be={APPLY_PASSBACK:"app",FIRST_RENDER_ENDED:"fimp",NG_REQUEST:"ngr",FILL_NO_AD:"fill"},Fe={POPUP_DISPLAYED:"owpd",BUTTON_CLICKED:"owbc",INTERSTITIAL_DISPLAYED:"owid",NO_AD:"owna",NO_RECEIVED_REWARD_RESPONSE:"ownr"},Et={CARPET:0,VIEWABLE_INTERVAL:3,VIDEO:4},ia="https://beacon.geniee.jp",Te=o=>{let e=new Blob([JSON.stringify(o)],{type:"text/plain"});navigator.sendBeacon(ia,e),l.beaconLog(o)},sa=1,On,fn=(On=window.gn_beacon_rate)!=null?On:sa,Mn,fr=(Mn=window.gn_beacon_enabled)!=null?Mn:Math.random()*100<=fn,hr=o=>{var t,r;return{t:Et.CARPET,rate:fn,mediaId:(r=(t=window.__gn_config)==null?void 0:t.mediaId)!=null?r:0,loc:window.location.href,eventType:o,pvId:Ee,elapsedTime:Math.floor(performance.now()),ver:fe}},Re=o=>{if(!fr)return;let e=hr(o);Te(e)},hn=()=>Re(na.LOAD_COMPLETED);var vn=()=>Re(Fe.POPUP_DISPLAYED),yn=()=>Re(Fe.BUTTON_CLICKED),En=()=>Re(Fe.INTERSTITIAL_DISPLAYED),Sn=()=>Re(Fe.NO_AD),An=o=>{o===0&&Re(Fe.NO_RECEIVED_REWARD_RESPONSE)},St=(o,e,t)=>{if(fr&&(!window.gnhb_event_targets||window.gnhb_event_targets.includes(e))){let r=v(u(u({},hr(o)),t),{divId:e});Te(r)}},bn=(o,e,t)=>{if(fr&&(!window.gnhb_event_targets||window.gnhb_event_targets.includes(e))){let r=v(u({},hr(o)),{divId:e,msg:t});Te(r)}},Tn=(o,e)=>St(be.APPLY_PASSBACK,o,{code:e}),Rn=(o,e)=>St(be.FIRST_RENDER_ENDED,o,{adServer:e}),wn=o=>{St(be.APPLY_PASSBACK,o,{})},In=(o,e)=>{bn(be.NG_REQUEST,o,e)},_n=(o,e)=>{bn(be.NG_REQUEST,o,e)},Pn=o=>St(be.FILL_NO_AD,o,{}),Cn=(o,e)=>{let t={t:Et.VIDEO,zid:e,tag:o};Te(t)};var vr=o=>{let e=o.deviceWidthTargeting;return e?ct(window.outerWidth,e):!0};var aa=()=>{let o=navigator.userAgent;return o?new RegExp("iPhone OS","i").test(o):!1},la=()=>{var e;let o=navigator.userAgent;return o?new RegExp("Android","i").test(o):((e=navigator.userAgentData)==null?void 0:e.platform)==="Android"},da=()=>{var e;let o=navigator.userAgent;return o?new RegExp("windows nt","i").test(o):((e=navigator.userAgentData)==null?void 0:e.platform)==="Windows"},ca=()=>{var e;let o=navigator.userAgent;return o?new RegExp("Macintosh","i").test(o):((e=navigator.userAgentData)==null?void 0:e.platform)==="macOS"},pa={iOS:aa,Android:la,Windows:da,MacOS:ca},J=o=>o.some(e=>pa[e]());var yr=o=>{let e=o.osTargeting;return e?e.isExclude?!J(e.osTypes):J(e.osTypes):!0};var xn=o=>[ua,ma,yr,vr].every(t=>t(o)),ma=slot=>slot.limitationScript?!!eval(slot.limitationScript):!0,ua=o=>{let e=Q("gn_video")==="true";return o.deliversOnlyDebugMode?e:!0};var ga=(o,e={})=>Object.entries(e).reduce((t,[r,n])=>(n&&t.setAttribute(r,n),t),o),fa=(o,e)=>(e&&(Array.isArray(e)?e:[e]).forEach(r=>o.appendChild(typeof r=="string"?document.createTextNode(r):r)),o),y=(o,e={},t)=>{let r=document.createElement(o);return ga(r,e),fa(r,t),r},At=()=>g(void 0,null,function*(){return new Promise(o=>{document.readyState==="loading"?window.addEventListener("DOMContentLoaded",()=>o(!0)):o(!0)})}),ha=(o,e)=>{let t=new ResizeObserver(e);return t.observe(o),()=>{t.unobserve(o),t.disconnect()}},va=o=>{let e=window.setInterval(()=>{o([],{observe:b,unobserve:t,disconnect:t})},1e3),t=()=>{window.clearInterval(e)};return t},Z=(o,e)=>window.ResizeObserver?ha(o,e):va(e),N=o=>{o.dataset[ve]=""},M=(o,e)=>{let t=document.head.appendChild(document.createElement("style"));e&&t.setAttribute("id",e);let r=t.sheet;for(let n of o)r.insertRule(n,r.cssRules.length);return t},Ln=(o,e)=>(Object.assign(o.style,e),o),Dn=o=>{let e=o.getBoundingClientRect(),t=e.width*e.height,r=e.bottom<=0||window.innerHeight<=e.top?0:Math.min(e.bottom,window.innerHeight)-Math.max(e.top,0),n=e.right<=0||window.innerWidth<=e.left?0:Math.min(e.right,window.innerWidth)-Math.max(e.left,0);return t>0?r*n/t:0},Fn=o=>{let e=null;try{e=document.querySelector(o)}catch(t){}return e},Nn=o=>{let e=document.createElement("div");return e.innerHTML=o,e.querySelectorAll("script").forEach(r=>{var i;let n=document.createElement("script");Array.from(r.attributes).forEach(s=>{n.setAttribute(s.name,s.value)}),n.innerHTML=r.innerHTML,(i=r.parentNode)==null||i.replaceChild(n,r)}),e},bt=(o,e)=>`${o}px ${e}px`,Tt=()=>{let o="gn_sc_cxl";window.document.getElementById(o)||M([`.${ye}, .${se} {
        position: fixed;
        width: 100%;
      }`,`body.${se} {
        overflow: hidden !important;
      }`],o)},Rt=()=>{let o="gn_hide_ads_behined";window.document.getElementById(o)||M([`[data-${ve}] {visibility: hidden !important;}`,`body:not(.${ye}):not(.${se}) [data-${ve}] {visibility: visible !important;}`],o)},Er=o=>{o.flatMap(t=>Array.from(window.document.querySelectorAll(t))).forEach(t=>{(t instanceof HTMLElement||t instanceof SVGElement)&&(N(t),l.log("make following element invisible while interstitial or offerwall is displaying.",t))})},Bn=o=>{let e=[];return o.split("").reduce(({ruleDraft:t,indentCount:r},n)=>{let i=t+n;switch(n){case"{":return{ruleDraft:i,indentCount:r+1};case"}":{let s=r-1;return s!==0?{ruleDraft:i,indentCount:s}:(e.push(i.trim()),{ruleDraft:"",indentCount:s})}default:return{ruleDraft:i,indentCount:r}}},{ruleDraft:"",indentCount:0}),e},Hn=o=>o.match(/^\d/)?"#"+o.replace(/^(\d)/,"\\3$1 "):"#"+o;var Un=(o,e,t)=>{e.innerHTML="";let r=Nn(o.tag);r.setAttribute("id",t),e.appendChild(r)};var kn=class{constructor(){this.name="PolicyChecker"}inquire(i,s,a){return g(this,arguments,function*(e,t,r,n=B){try{let d=this.makeURL(e,t,r);if(!d)throw"no loc found";let c=yield ht(d,n);return this.checkResult(c)}catch(d){return l.errorLog("PolicyChecker",d),!1}})}makeURL(e,t,r){let n={loc:ft(),list_id:r?"1":`mid-${e}`,gam_id:t.map(i=>`gam-${i}`).join()};return n.loc?`https://${H.PATH}${pr(n)}`:""}checkResult(e){try{let t=JSON.parse(e),r=t.count===0;return t.msg?l.errorLog(this.name,t.msg):l.log(this.name,"isPolicyOK:",r),r}catch(t){return l.errorLog(this.name,"API Response was broken",t),!1}}},wt=kn;var Gn=o=>pt(o,"weight"),Vn=(o,e,t)=>g(void 0,null,function*(){let[r,n]=pn(i=>i.isFiller,o);return t?(yield new wt().inquire(String(e.mediaId),["9116787","21687543875","424536528"],!1,e.timeout))?n:r:n}),zn=o=>{let e=o.find(t=>t.vendor===Q("gn_video_player"));return e!=null?e:null};var qn=(o,e,t)=>g(void 0,null,function*(){let r=Fn(o),n=!!document.getElementById(e.slotDiv);if(!r||n||!xn(e))return;let i=yield Vn(e.tags,t,e.usePolicyChecker),s=zn(e.tags)||Gn(i);l.log("[Third party tag]: chosen tag is ",s),!!s&&(Un(s,r,e.slotDiv),e.sendsLog&&Cn(s.vendor,e.aladdinZoneId))});var $n=(o,e)=>u(u({},o),ya(e.params.expires)?{expired:1}:{}),ya=o=>{if(!o)return!1;let[e,t,r]=o.split("-").map(i=>parseInt(i,10)),n=Date.UTC(e,t-1,r,23-9,59,59);return Date.now()>n};var m={time:{morn:1,noon:2,night:3},os:{iOS:"iOS",Android:"Android",MacOS:"MacOS",Windows:"Windows",Other:"Other"},language:{jp:1,other:-1}},Wn=o=>{let e=new Date(Date.now()+(new Date().getTimezoneOffset()+9*60)*60*1e3).getHours(),t=Aa(e),r=ba(o),n=Sa(navigator.language);return{time:t,os:r,language:n}},It=()=>{let o=[{clusterType:1,clientFeature:{time:m.time.morn,os:m.os.iOS,language:m.language.jp}},{clusterType:2,clientFeature:{time:m.time.morn,os:m.os.iOS,language:m.language.other}},{clusterType:3,clientFeature:{time:m.time.morn,os:m.os.Android,language:m.language.jp}},{clusterType:4,clientFeature:{time:m.time.morn,os:m.os.Android,language:m.language.other}},{clusterType:5,clientFeature:{time:m.time.morn,os:m.os.Other,language:m.language.jp}},{clusterType:6,clientFeature:{time:m.time.morn,os:m.os.Other,language:m.language.other}},{clusterType:7,clientFeature:{time:m.time.noon,os:m.os.iOS,language:m.language.jp}},{clusterType:8,clientFeature:{time:m.time.noon,os:m.os.iOS,language:m.language.other}},{clusterType:9,clientFeature:{time:m.time.noon,os:m.os.Android,language:m.language.jp}},{clusterType:10,clientFeature:{time:m.time.noon,os:m.os.Android,language:m.language.other}},{clusterType:11,clientFeature:{time:m.time.noon,os:m.os.Other,language:m.language.jp}},{clusterType:12,clientFeature:{time:m.time.noon,os:m.os.Other,language:m.language.other}},{clusterType:13,clientFeature:{time:m.time.night,os:m.os.iOS,language:m.language.jp}},{clusterType:14,clientFeature:{time:m.time.night,os:m.os.iOS,language:m.language.other}},{clusterType:15,clientFeature:{time:m.time.night,os:m.os.Android,language:m.language.jp}},{clusterType:16,clientFeature:{time:m.time.night,os:m.os.Android,language:m.language.other}},{clusterType:17,clientFeature:{time:m.time.night,os:m.os.Other,language:m.language.jp}},{clusterType:18,clientFeature:{time:m.time.night,os:m.os.Other,language:m.language.other}}],{time:e,os:t,language:r}=Wn(["iOS","Android"]),n=o.find(({clientFeature:i})=>i.time===e&&i.os===t&&i.language===r);if(!n)throw new Error("cluster does not found.");return n.clusterType};var Yn=()=>{let o=[{clusterType:1,clientFeature:{os:m.os.iOS,language:m.language.jp}},{clusterType:2,clientFeature:{os:m.os.iOS,language:m.language.other}},{clusterType:3,clientFeature:{os:m.os.Android,language:m.language.jp}},{clusterType:4,clientFeature:{os:m.os.Android,language:m.language.other}},{clusterType:5,clientFeature:{os:m.os.Other,language:m.language.jp}},{clusterType:6,clientFeature:{os:m.os.Other,language:m.language.other}}],{os:e,language:t}=Wn(["iOS","Android"]),r=o.find(({clientFeature:n})=>n.os===e&&n.language===t);if(!r)throw new Error("cluster does not found.");return r.clusterType},Ea=o=>/^ja\b/.test(o),Sa=o=>Ea(o)?m.language.jp:m.language.other,Aa=o=>{let t=(r=>(n,i)=>n<=r&&r<i)(o);return t(3,11)?m.time.morn:t(11,18)?m.time.noon:m.time.night},ba=o=>{var e;return(e=o.find(t=>J([t])))!=null?e:m.os.Other};function jn(){return Math.sqrt(-2*Math.log(1-Math.random()))*Math.cos(2*Math.PI*Math.random())}"use strict";var Kn=Math.log,Qn=Math.sqrt,Ta=Math.pow,Xn=1/3;function Sr(o,e,t){var r,n,i,s,a,d,c,f,S,_;for(t<1?(d=t+1-Xn,a=1/Qn(9*d),f=Ta(o(),1/t)):(d=t-Xn,a=1/Qn(9*d),f=1),r=!0;r;){do c=e(),_=1+a*c;while(_<=0);_*=_*_,n=c*c,i=1-.331*n*n,s=.5*n+d*(1-_+Kn(_)),S=o(),(S<i||Kn(S)<s)&&(r=!1)}return d*_*f}"use strict";var Ar=Math.pow,Jn=Math.log;function Zn(o,e,t){var r,n,i,s,a,d,c,f;for(i=t-1,a=Ar(i+i,.5),r=!0;r===!0;)s=e(),c=.5*(1+s/a),c>=0&&c<=1&&(d=o(),n=Ar(s,4),f=8*t-12,f=1-n/f,d<=f?r=!1:(f+=.5*Ar(n/(8*t-8),2),d<f&&(f=i*Jn(4*c*(1-c)),f+=s*s/2,f>=Jn(d)&&(r=!1))));return c}"use strict";var Ra=Math.pow,_t=Math.log;function ei(o,e,t,r){var n,i,s,a,d,c,f,S,_,D,oe;for(a=t-1,d=r-1,c=a+d,f=c*_t(c),s=a/c,n=.5/Ra(c,.5),i=!0;i===!0;)S=e(),D=s+S*n,D>=0&&D<=1&&(_=o(),oe=a*_t(D/a),oe+=d*_t((1-D)/d),oe+=f+.5*S*S,oe>=_t(_)&&(i=!1));return D}"use strict";var br=Math.exp,ti=Math.pow,Tr=Math.log;function ri(o,e,t){for(var r,n,i,s,a,d,c;;)if(s=o(),a=o(),d=ti(s,1/e),c=ti(a,1/t),i=d+c,i<=1)return i>0?d/i:(r=Tr(s)/e,n=Tr(a)/t,r>n?(n-=r,r=0):(r-=n,n=0),br(r-Tr(br(r)+br(n))))}"use strict";function oi(o,e,t,r){var n,i;return t===r&&t>1.5?Zn(o,e,t):t>1&&r>1?ei(o,e,t,r):t<1&&r<1?ri(o,t,r):(n=Sr(o,e,t),i=Sr(o,e,r),n/(n+i))}var ni=(o,e)=>{if(o<=0||e<=0)throw new Error("alpha and beta must be positive");return oi(Math.random,jn,o,e)};var Pt=(o,e)=>{let t=o.params.clusters.find(n=>n.clusterType===e);if(!t)return;let r=Ia(t);if(!!r)return{cluster:t.clusterType,minPrice:r.minPrice,logicVersion:o.version}},ii=(o,e)=>{let t=o.params.clusters.find(n=>n.clusterType===e);if(!t)return;let r=wa(t);if(!!r)return{cluster:t.clusterType,minPrice:r.minPrice,logicVersion:o.version}},wa=o=>{let e=o.uprs;return e.length===0?void 0:e.map(r=>{let n=si(r);return{upr:r,revenue:r.ecpmGam*n+r.rpmAladdin*(1-n)}}).reduce((r,n)=>r.revenue<n.revenue?n:r).upr},Ia=o=>{let e=o.uprs;return e.length===0?void 0:e.map(r=>{let n=si(r);return{upr:r,revenue:r.ecpmGam*n}}).reduce((r,n)=>r.revenue<n.revenue?n:r).upr},si=o=>ni(o.alphaPrior+o.impGam,o.betaPrior+o.totalImp-o.impGam);var we={minPrice:"carpet-upr",cluster:"carpet-cls-id",logicVersion:"cpt-upr-ver",expired:"cpt-upr-expired"},Rr=o=>{let e;switch(o.version){case"v0.1":e=Pt(o,It());break;case"v1.0":case"v2.0":e=Pt(o,It());break;case"v3.0":e=Pt(o,Yn());break;case"v4.0":case"v5.0":e=ii(o,It());break}if(!!e)return _a($n(e,o))},ai=(o,e)=>{var n;let t=(n=e.get(o))==null?void 0:n.tag;if((t==null?void 0:t.adServer)!=="gam"||!t.upr)return null;let r=Rr(t.upr);return r||null},_a=o=>u({[we.minPrice]:o.minPrice.toString(),[we.cluster]:o.cluster.toString(),[we.logicVersion]:o.logicVersion},o.expired?{[we.expired]:o.expired.toString()}:{});var Ct={SHOW_CLOSE:"CptAldOv"},R={RENDERED:"CptAdRendered",FORMATTED:"CptAdFormatApplied",RESIZED:"CptAdResized",CLOSED:"CptAdClosed"},T=class{static postMessage(e){window.postMessage(e,"*")}static removeAllListeners(){this.removeFns.forEach(e=>e()),this.removeFns=[]}static addMessageListenerOnce(e,t){let r=i=>{var s;((s=i.data)==null?void 0:s.type)===e&&t(i)&&window.removeEventListener("message",r)};window.addEventListener("message",r),l.eventLog("message received:",e);let n=()=>window.removeEventListener("message",r);return this.removeFns.push(n),n}static addMessageListener(e,t){let r=i=>{var s;typeof i.data!="string"&&((s=i.data)==null?void 0:s.type)===e&&(l.eventLog("message received:",e),t(i))};window.addEventListener("message",r);let n=()=>window.removeEventListener("message",r);return this.removeFns.push(n),n}};T.removeFns=[];var Pa=o=>{if(o.selector==="getElementById")return document.getElementById(o.query);if(o.selector==="querySelectorAll")return document.querySelectorAll(o.query)[o.index];if(o.selector==="getElementsByClassName")return document.getElementsByClassName(o.query)[o.index];throw Error("invalid AdWithQuery property 'selector': "+o.selector)},Ca=o=>{let e=y("div",{id:o.divId});o.minHeight&&(e.style.minHeight=`${o.minHeight}px`);let t=y("div");return t.setAttribute("data-cptid",o.divId),t.style.display="block",t.appendChild(e),t},Oa=(o,e,t)=>{var r,n;if(o.position==="firstChild")e.insertBefore(t,e.firstChild);else if(o.position==="lastChild")e.appendChild(t);else if(o.position==="justBefore")(r=e.parentNode)==null||r.insertBefore(t,e);else if(o.position==="justAfter")(n=e.parentNode)==null||n.insertBefore(t,e.nextSibling);else throw Error("invalid AdWithQuery property: 'position'"+o.position)},Ma=o=>{let e=Pa(o);if(!e)throw Error("target element not found. query: "+JSON.stringify(o));let t=Ca(o);Oa(o,e,t)},li={timeout:1e3*90,interval:10},di=(o,e,t=li)=>{let r=u(u({},li),t),n=!1,i=setInterval(()=>{try{Ma(e),o.permit(e.divId),clearInterval(i),wn(e.divId),n=!0}catch(s){l.log(s)}},r.interval);setTimeout(()=>{n||(l.errorLog("appendAd timeout"),clearInterval(i),In(e.divId,`insertAdDynamically timeout: divId: ${e.divId}`))},r.timeout)};var wr=class{constructor(e){var t;this.buttonSize=(t=e==null?void 0:e.sideSize)!=null?t:0,this.buttonPos=e==null?void 0:e.position}createDocumentMargin(e){let t=document.createElement("div");return t.setAttribute("id",st),t.style.width="100%",t.style.height=`${e}px`,t}insertDocumentMargin(e){let t=this.createDocumentMargin(e);document.body.insertAdjacentElement("beforeend",t)}onload(e,t,r){if(document.getElementById(st))return;let i=ci(e,t,this.buttonSize,this.buttonPos);this.insertDocumentMargin(i)}onResize(e,t,r){let n=document.getElementById(st);if(!n)return;let i=ci(e,t,this.buttonSize,this.buttonPos);n.style.height=`${i}px`}},ci=(o,e,t,r)=>{let n=o.clientHeight;if(o.clientHeight<1)return 0;let i=e.style.transform.match(/scale\(([^)]+)\)/),s=i?parseFloat(i[1]):1;switch(r){case O.MIDDLE_LEFT:case O.MIDDLE_RIGHT:return n*s;default:return(n+t)*s}};var xa=()=>{let o='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="16" height="16" style="vertical-align:bottom;"><g><polygon points="512,52.535 459.467,0.002 256.002,203.462 52.538,0.002 0,52.535 203.47,256.005 0,459.465 52.533,511.998 256.002,308.527 459.467,511.998 512,459.475 308.536,256.005" style="fill:#000;stroke:#000;stroke-width:10px;"></polygon></g></svg>',e=y("span",{id:V,role:"button",style:"position:absolute;top:-16px;left:0;width:16px;height:16px;line-height:16px;display:none;"});return e.innerHTML=o,e},pi=o=>{let e=xa();return o.insertAdjacentElement("afterbegin",e),e.addEventListener("click",()=>{o.style.display="none"}),e},Ot=(o,e)=>{o.addEventListener("click",()=>{window.postMessage({type:he,slotDiv:e},"*")})},Mt=(o,e)=>{o.addEventListener("click",()=>{T.postMessage({type:R.CLOSED,slotDiv:e})})},xt=(o,e)=>T.addMessageListener(Ct.SHOW_CLOSE,r=>{e===r.data.divId&&(o.style.display="block")}),le=(o,e)=>{o.style.width=`${o.clientWidth}px`,o.style.height=`${o.clientHeight}px`,o.style.margin="0",e.style.opacity="1";let t=o.querySelector("iframe");!t||(t.style.margin="0")},La=1.5,mi=(o,e)=>{var t;try{let r=e.clientWidth,i=Math.min(((t=window.top)==null?void 0:t.innerWidth)||Number.MAX_SAFE_INTEGER,document.documentElement.clientWidth)/r||1;i<=La&&Da(o,i,r)}catch(r){}},Da=(o,e,t)=>{o.style.transform=`scale(${e})`,o.style.transformOrigin=e<1?"left bottom":"bottom",o.style.width=t+"px"},Lt=(o,[e,t])=>(e.clientHeight>1&&o(e,t),Z(e,()=>{e.clientHeight>1&&o(e,t)}));var Ir=class{constructor(e){this.setting=e;this.teardown=null}setColorCss(e){e.style.backgroundColor=this.setting.bgColor;let t=e.querySelector("svg polygon");if(!t)throw Error(ne);return t.style.fill=this.setting.color,e}setInnerItemOrder(e){switch(this.setting.position){case O.UPPER_LEFT:case O.LOWER_LEFT:e.style.flexDirection="row",e.style.justifyContent="flex-start";break;case O.UPPER_RIGHT:case O.LOWER_RIGHT:e.style.flexDirection="row",e.style.justifyContent="flex-end";break;case O.MIDDLE_LEFT:e.style.flexDirection="row",e.style.justifyContent="flex-end";break;case O.MIDDLE_RIGHT:e.style.flexDirection="row-reverse",e.style.justifyContent="flex-end";break}}setSizeCss(e){let t=e.querySelector("svg");if(!t)throw Error(ne);return e.style.width=`${this.setting.sideSize}px`,e.style.height=`${this.setting.sideSize}px`,e.style.lineHeight=`${this.setting.sideSize}px`,t.style.width=`${this.setting.sideSize}px`,t.style.height=`${this.setting.sideSize}px`,e}createCloseButton(){let e='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="vertical-align:bottom;"><g><polygon points="512,52.535 459.467,0.002 256.002,203.462 52.538,0.002 0,52.535 203.47,256.005 0,459.465 52.533,511.998 256.002,308.527 459.467,511.998 512,459.475 308.536,256.005" style="fill:#000;stroke:#000;stroke-width:10px;"></polygon></g></svg>',t=y("span",{id:V,role:"button",style:`line-height:${this.setting.sideSize};display:none;`});return t.innerHTML=e,t}insertCloseButton(e,t){let r=this.createCloseButton();return t.insertAdjacentElement("afterbegin",r),r.addEventListener("click",()=>{e.style.display="none"}),r}create(e,t){this.setInnerItemOrder(t);let r=this.insertCloseButton(e,t);return this.setColorCss(r),this.setSizeCss(r),!0}after(e,t){var n;if(!e)throw new Error(ne);let r=e.getElementById(V);if(!r)throw new Error(ne);return Ot(r,t.id),Mt(r,t.id),(n=this.teardown)==null||n.call(this),this.teardown=xt(r,t.id),!0}};var _r=class{constructor(e,t){this.useHeaderOV=e;this.widthSetting=t}tryExpandOuter(e,t,r){var n;try{if(r.clientWidth<=1)return!1;let s=Math.min(((n=window.top)==null?void 0:n.innerWidth)||Number.MAX_SAFE_INTEGER,document.documentElement.clientWidth)/r.clientWidth,a=e.clientHeight*s>this.widthSetting.maxHeight?this.widthSetting.maxHeight/e.clientHeight:s;return a<=_r.MAX_EXPAND_SCALE?(this.execExpandOuter(t,a),!0):!1}catch(i){return!1}}execExpandOuter(e,t){e.style.transform=`scale(${t})`;let r;this.useHeaderOV?r=t<1?"left top":"top":r=t<1?"left bottom":"bottom",e.style.transformOrigin=r}onload(e,t,r){this.tryExpandOuter(e,t,r)}onResize(e,t,r){this.tryExpandOuter(e,t,r)}},Ie=_r;Ie.MAX_EXPAND_SCALE=1.5;var Be=class{constructor(e){this.maxHeight=e}onload(e,t,r){let n=Be.createBar();this.resizeBar(n,e,r.clientWidth),r.appendChild(n)}onResize(e,t,r){let n=document.getElementById(sr);!n||this.resizeBar(n,e,r.clientWidth)}resizeBar(e,t,r){var c;if(Math.abs(this.maxHeight-t.getBoundingClientRect().height)<1){e.style.height="0px",e.innerHTML="";return}let i=Math.min(((c=window.top)==null?void 0:c.innerWidth)||Number.MAX_SAFE_INTEGER,document.documentElement.clientWidth)/r,s=i>Ie.MAX_EXPAND_SCALE?this.maxHeight:this.maxHeight/i,a=Math.max(0,s-t.clientHeight),d=Math.min(Be.MAX_FONT_SIZE,a);e.style.height=`${a}px`,e.style.lineHeight=`${a}px`,e.style.fontSize=`${d}px`,a>Be.MIN_TEXT_HEIGHT?e.innerHTML="PR":e.innerHTML="",e.style.width=`${t.clientWidth}px`}static createBar(){return y("ins",{id:sr,style:"display:block;width:0px;height:0px;margin:0;padding:0;background-color:black;color:white;text-align:center;text-decoration:none;"})}},Ne=Be;Ne.MIN_TEXT_HEIGHT=10,Ne.MAX_FONT_SIZE=20;var Pr=class{createDocumentMargin(){let e=document.getElementById(it);e&&e.remove();let t=document.createElement("div");return t.setAttribute("id",it),t.style.width="100%",t}insertDocumentMargin(){let e=this.createDocumentMargin();document.body.insertAdjacentElement("afterbegin",e);let t=document.getElementById(V);return t&&t.addEventListener("click",()=>{e.remove()}),e}create(e,t){return e.style.top="0px",e.style.bottom="",t.style.flexWrap="wrap-reverse",I(e,Me,"0px"),I(e,xe,'""'),!0}onload(e,t,r){let n=this.insertDocumentMargin();n.style.height=`${r.getBoundingClientRect().height}px`}onResize(e,t,r){let n=document.getElementById(it);!n||(n.style.height=`${r.getBoundingClientRect().height}px`)}};var Cr=class{constructor(e){this.delay=e!=null?e:0}create(e){return e.style.visibility="hidden",!0}onload(e,t){this.visibleWithDelay(e,t)}onResize(e,t){this.visibleWithDelay(e,t)}visibleWithDelay(e,t){e.clientHeight>1&&window.setTimeout(()=>{t.style.visibility="visible"},this.delay)}};var Or=class{constructor(e){this.rules=e;this.insertedIndices=[],this.sheet=this.createNewStyleSheet()}insertRules(){return!this.insertedIndices.length&&this.sheet&&(this.insertedIndices=this.rules.map(e=>this.sheet.insertRule(e,this.sheet.cssRules.length))),this.insertedIndices}deleteRules(){return this.insertedIndices.length?(this.insertedIndices.forEach(e=>this.sheet.deleteRule(e)),this.insertedIndices=[],!0):!1}redefineRules(){return this.deleteRules(),this.insertRules()}createNewStyleSheet(){return document.head.appendChild(document.createElement("style")).sheet}};var Fa=34,Mr="geniee_overlay__iosub",ui="geniee_overlay_boot",He="CptApplyUpperBase",Na="CptCancelUpperBase",Ba=o=>o*window.innerHeight/screen.height,gi=class{constructor(e,t){this.targetQuery=e;this.className=t;this.target=null,this.fullHeight=window.innerHeight,this.fullWidth=window.innerWidth,this.wasOrientationPortrait=this.isPortRait(),this.updateFullViewport()}apply(){let e=document.querySelector(this.targetQuery);if(!e)return;this.target=e;let t=this.updateFullViewport();this.isToolbarShown()||!this.isPortRait()||!this.wasOrientationPortrait?this.target.classList.remove(this.className):this.target.classList.add(this.className),t()}cancel(){var e;(e=this.target)==null||e.classList.remove(this.className)}updateFullViewport(){return this.isOrientationChanged()?this.onOrientationChangeHandler():this.onResizeHandler()}isToolbarShown(){return this.fullHeight!==window.innerHeight}isOrientationChanged(){return this.isPortRait()!==this.wasOrientationPortrait}isPortRait(){return window.matchMedia("(orientation: portrait)").matches}onOrientationChangeHandler(){var e;return this.wasOrientationPortrait?(e=this.target)==null||e.classList.remove(this.className):(this.fullHeight=Math.max(this.fullHeight,window.innerHeight),this.fullWidth=Math.max(this.fullWidth,window.innerWidth)),()=>{this.wasOrientationPortrait=this.isPortRait()}}onResizeHandler(){return this.wasOrientationPortrait&&(this.fullHeight=Math.max(this.fullHeight,window.innerHeight),this.fullWidth=Math.max(this.fullWidth,window.innerWidth)),()=>{}}},z=class{constructor(){this.togglePolicy=new gi(`#${C}`,Mr),this.styleAtattcher=new Or([`.${Mr} {
        border-bottom: black solid ${Ba(Fa)}px;
      }`]),this.abortFns=[],this.isLevitateTarget=this.isiPhone()&&!this.isIOS15AndSafari()}isiPhone(){var e;return!!((e=navigator.userAgent)==null?void 0:e.match(/iPhone/i))}isIOS15AndSafari(){var e;return!!((e=navigator.userAgent)==null?void 0:e.match(/iPhone OS 15.+Version.+Safari/i))}apply(){var e;!this.isLevitateTarget||(this.flushAbortFns(),(e=this.styleAtattcher)==null||e.redefineRules(),this.abortFns=[this.setResizeEvent(),this.receiveCancelMessageEvent()])}upsertBootEl(){return g(this,null,function*(){var t;if(!this.isLevitateTarget)return;let e=(t=document.getElementById(ui))!=null?t:y("ins",{id:ui,style:"height:0px;width:0px;display:block;"});e.classList.add(Mr),yield At(),document.body.appendChild(e)})}cancel(){var e,t;(e=this.styleAtattcher)==null||e.deleteRules(),(t=this.togglePolicy)==null||t.cancel(),this.flushAbortFns()}setResizeEvent(){return this.addRemovableEvent("resize",this.wrapRaf(()=>{var e;return this.isiPhone()&&((e=this.togglePolicy)==null?void 0:e.apply())}),!1)}flushAbortFns(){this.abortFns.forEach(e=>e()),this.abortFns=[]}receiveCancelMessageEvent(){return this.addRemovableEvent("message",e=>{var t;((t=e==null?void 0:e.data)==null?void 0:t.type)===Na&&this.cancel()})}wrapRaf(e){let t=null,r=()=>{e(),t&&window.cancelAnimationFrame(t),t=null};return()=>{t=t||window.requestAnimationFrame(r)}}addRemovableEvent(e,t,r){var n;return(n=window.top)==null||n.addEventListener(e,t,r),()=>{var i;(i=window.top)==null||i.removeEventListener(e,t,r)}}};var xr=class{constructor(e){this.settings=e;this.levitate=null,this.isMessageReceiverSet=!1}after(e,t){return e?(this.addMessageReceiver(),!!t):!1}onload(e,t,r){this.settings.useAlways&&window.postMessage({type:He},"*")}addMessageReceiver(){this.isMessageReceiverSet||(window.addEventListener("message",e=>{var t;((t=e==null?void 0:e.data)==null?void 0:t.type)===He&&this.applyLevitate()}),this.isMessageReceiverSet=!0)}applyLevitate(){this.levitate||(this.levitate=new z),this.levitate.apply(),this.levitate.upsertBootEl()}};var Lr=class{constructor({bgColor:e,closeButton:t}){var r;this.bgColor=e,this.buttonSize=(r=t==null?void 0:t.sideSize)!=null?r:0,this.buttonPos=t==null?void 0:t.position}create(e,t){return!e||!t?!1:(I(e,Me,'""'),I(e,xe,"0px"),!0)}onload(e,t,r){e.style.display="inline-block",this.resizeOverlay(e,t,r),this.defineBackground()}defineBackground(){M([`#${U}::before {
        content: "";
        display: block;
        width: 100%;
        height: var(${at});
        background-color: ${this.bgColor};
        position: absolute;
        top: var(${Me});
        bottom: var(${xe});
        left: 0px;
        right: 0px;
        z-index: -1;
      }`])}resizeOverlay(e,t,r){if(!(e.clientHeight<=1))switch(this.buttonPos){case O.MIDDLE_LEFT:case O.MIDDLE_RIGHT:r.style.width=`${e.clientWidth+this.buttonSize}px`,I(t,at,`${r.clientHeight}px`);break;default:r.style.width=`${e.clientWidth}px`,I(t,at,`${e.clientHeight}px`);break}}onResize(e,t,r){this.resizeOverlay(e,t,r)}};var O={UPPER_LEFT:1,UPPER_RIGHT:2,LOWER_LEFT:3,LOWER_RIGHT:4,MIDDLE_LEFT:5,MIDDLE_RIGHT:6},Dr=o=>{let e=[];return e.push(new Lr(o)),o.closeButton&&e.push(new Ir(o.closeButton)),o.useHeaderOV&&e.push(new Pr),o.expansion&&(e.push(new Ie(o.useHeaderOV,o.expansion)),o.expansion.useComplementBar&&e.push(new Ne(o.expansion.maxHeight))),o.levitation&&e.push(new xr(o.levitation)),o.preventsBottomContentOverlap&&e.push(new wr(o.closeButton)),o.preventsInvisibleAdClick&&e.push(new Cr(window.gn_ov_display_delay)),e};var h={DEFAULT:1,OV:2,OV_NO_CLOSE:3,OV_IPHONE_UPPERBASE:4,INTERSTITIAL:5,OV_IPHONE_UPPERBASE_BOOT:6,OV_IPHONE_NO_CLOSE_UPPERBASE_BOOT:7,OV_LEVITATE:8,OV_LEVITATE_NOCLOSE:9,CUSTOM_OV:10,IN_PAGE:11,VH_BANNER:12,EXPAND_BANNER:13,MULTIPLEX:14,INFEED:15,NATIVE:16},fi=[h.OV,h.CUSTOM_OV,h.OV_LEVITATE,h.OV_NO_CLOSE,h.OV_IPHONE_UPPERBASE,h.OV_IPHONE_UPPERBASE_BOOT,h.OV_IPHONE_NO_CLOSE_UPPERBASE_BOOT,h.OV_LEVITATE_NOCLOSE],Fr=o=>typeof o!="object"||o===null||!("formatSpec"in o)?!1:o.formatSpec.id===h.INTERSTITIAL;function Dt(o){return o===h.CUSTOM_OV?{id:o,params:{useHeaderOV:!1,preventsBottomContentOverlap:!1,bgColor:"rgba(0,0,0,0)",expansion:{maxHeight:200},closeButton:{bgColor:"rgba(0,0,0,0)",color:"rgba(0,0,0,1)",position:O.UPPER_LEFT,sideSize:16}}}:o===h.IN_PAGE?{id:o,params:{useExpansion:!1,excludeAladdin:!0}}:{id:o}}var hi=(()=>{let o=[h.OV,h.OV_LEVITATE,h.OV_IPHONE_UPPERBASE,h.OV_IPHONE_UPPERBASE_BOOT,h.CUSTOM_OV];return e=>o.includes(e.formatSpec.id)})();var de="gam",_e="aladdin",Pe=class{constructor(e){if(this._settings=this.createSettings(e),this._renderParams=this.createRenderParams(this.settings),this.renderParams.formatSpec.id===h.MULTIPLEX){let r=this.renderParams.formatSpec.params.infeedParams.map(n=>this.createInfeedSlotForMultiplex(n));this.renderParams.formatSpec.params.infeedSlots=r}}getPrebidTargetings(){var r,n,i;let e=Object.values(j).reduce((s,a)=>v(u({},s),{[a]:this.renderParams.targeting[a]}),{}),t=!!((i=(n=(r=window.gnpb)==null?void 0:r.getAllWinningBids)==null?void 0:n.call(r))!=null?i:[]).find(s=>s.adId===e.hb_adid&&this.adUnitPath===s.adUnitCode);return v(u({},e),{rendered:t})}getRenderedPrebidBidder(){let e=this.getPrebidTargetings();if(!!e.rendered)return e.hb_bidder}get isInterstitial(){return this.divId===K}get isOverlay(){return fi.includes(this.settings.formatSpec.id)}get isRefreshable(){return!this.isInterstitial&&!!this.settings.refresh&&this.settings.refresh.use}get hasStoppedGamTraffic(){return this.renderParams.adServer===_e}get oldAdUnitPath(){return`/${this._settings.gamId}/${this._settings.code}`}get adUnitPath(){return this.settings.childGamId?`/${this.settings.gamId},${this.settings.childGamId}/${this.settings.code}`:`/${this.settings.gamId}/${this.settings.code}`}get zoneId(){var e,t;return(t=(e=this.settings.aladdinZoneInfo)==null?void 0:e.id)!=null?t:null}get slotMap(){let e=this.zoneId;return e===null?null:{adUnitPath:this.adUnitPath,zoneId:e}}get divId(){return"slotDiv"in this.settings?this.settings.slotDiv:K}get useAladdinAdapter(){return this.settings.useAladdinAdapter}get generalSlotSizes(){return this.settings.allowGAMFluidSize?this.settings.slotSizes?[...this.settings.slotSizes,"fluid"]:"fluid":this.settings.slotSizes}get tag(){var e;return this.renderParams.adServer===de?{adServer:this.renderParams.adServer,slotPath:this.adUnitPath,slotSizes:this.generalSlotSizes,minPriceRule:this.settings.minPriceRule,upr:this.settings.upr,fillNoAd:!!((e=this.settings.aladdinZoneInfo)==null?void 0:e.fillNoAd)}:this.settings.aladdinZoneInfo?{adServer:this.renderParams.adServer,id:this.settings.aladdinZoneInfo.id,size:this.settings.aladdinZoneInfo.size}:null}get weight(){return this.settings.weight}get settings(){return this._settings}get renderParams(){return this._renderParams}get isReady(){return this._renderParams.isGamSlotExists||this._renderParams.isPassback||this.isInterstitial||this.hasStoppedGamTraffic}get canUseHB(){return!!this.settings.gn_hb&&(!this.hasStoppedGamTraffic||this.isInterstitial||this.useAladdinAdapter)}getPrebidRefreshPolicyFor(e){var n,i,s,a,d;let t=(i=(n=window.gn_prebid_refresh_policy)==null?void 0:n[this.divId])!=null?i:[];return(d=[...(a=(s=this.settings.refresh)==null?void 0:s.prebidRefreshPolicies)!=null?a:[],...t].find(c=>c.bidder===e))!=null?d:null}updateRenderParams(e){let t=this._renderParams,r=Object.assign({},t.targeting,e.targeting);return this._renderParams=Object.assign({},u({},t),v(u({},e),{targeting:r})),this._renderParams}createSettings(e){let t=Fr(e)?e.aladdinZoneInfo:e.fillzone;return v(u({aladdinZoneInfo:t},e),{minPriceRule:Fr(e)?void 0:e.minPriceRule,refresh:mt(e.refresh,Mo,"use")})}createRenderParams(e){return{adServer:e.stopGamTraffic?"aladdin":"gam",targeting:{[Do]:"true",[Fo]:No,[Lo]:this.divId},formatSpec:u({},e.formatSpec),isGamSlotExists:!1,isPassback:!1,pureAd:e.pureAd,isApplied:!1}}createInfeedSlotForMultiplex({adUnitCode:e,aladdinZoneId:t,slotDiv:r}){let n=this.settings.aladdinZoneInfo,i=n?v(u({},n),{id:t}):void 0,s=v(u({},this.settings),{formatSpec:{id:h.INFEED,params:{}},code:e,slotDiv:r,aladdinZoneInfo:i,fillzone:i});return new Pe(s)}};var Ha=";",Nr=class{constructor(e){this.selectors=e}makeAdSlotsPreset(e){let r=this.preChooseAdUnits(e).map(s=>new Pe(s)),n=r.map(s=>s.divId),i=e.map(s=>new Pe(s).divId).filter(s=>n.indexOf(s)<0);return window.localStorage.setItem(Jo,JSON.stringify(i)),this.chooseAdSlots(r)}chooseAdSlots(e){return this.chooseAdSlotsFromChunk(this.forceAdSlotsByQueryStrings(this.createAdSlotsChunk(e)))}forceAdSlotsByQueryStrings(e){let t=Q(jo).split(Ha).filter(r=>!!r);return t.length===0?e:e.map(r=>{let n=r.filter(i=>t.includes(i.adUnitPath));return n.length===0?r:n})}createAdSlotsChunk(e){return e.sort((t,r)=>t.divId.localeCompare(r.divId)).reduce((t,r)=>{var s;let n=(s=t[0][0])==null?void 0:s.divId;return n&&r.divId==n?t[0].unshift(r):t.unshift([r]),t},[[]]).reverse()}chooseAdSlotsFromChunk(e){return e.map(t=>pt(t,"weight")).filter(ut)}preChooseAdUnits(e){return this.selectors.reduce((t,r)=>r(t),e)}};var Ua=o=>{var i;let e=(i=window.ld_blog_vars)==null?void 0:i.current_page.type,t="index",r="article",n="none";switch(e){case t:return o.filter(s=>s.pageType===t||s.pageType===n);case r:return o.filter(s=>s.pageType===r||s.pageType===n);default:return o}},ka=o=>{let e=an();return o.filter(r=>{let n=r.minWidthBreakpoint?r.minWidthBreakpoint:0,i=r.maxWidthBreakpoint?r.maxWidthBreakpoint:Number.MAX_SAFE_INTEGER;return n<=e&&e<=i})},Ga=o=>o.filter(e=>e.osTargetings?e.osTargetings.excludesTargetOS?!J(e.osTargetings.osTypes):J(e.osTargetings.osTypes):!0),vi=o=>{let e=[ka,Ga],t=[Ua];return o?e.concat(t):e};var Ft=class{constructor(){this.name="AdSlotService",this.adSlots=new Map,this.renderParamsResevation=[],this.permittedDivIds=null}get isAdSlotsReady(){return!!this.adSlots.size}permitRegister(e){var t;e.forEach(r=>{l.log(this.name,`permits registerAdSlots for divId "${r}"`)}),this.permittedDivIds=[...(t=this.permittedDivIds)!=null?t:[],...e]}registerAdSlots(e){let t=e.some(d=>d.pageType),i=new Nr(vi(t)).makeAdSlotsPreset(e).filter(d=>!this.adSlots.has(d.divId)),s=this.permittedDivIds;return(s?i.filter(d=>s.includes(d.divId)):i).forEach(d=>{l.log(this.name,`register adUnit for divId "${d.divId}"`),this.adSlots.set(d.divId,d)}),this.applyReservedParams(),this.applyReservedParams(),this.getAll()}reserveRenderParams(e,t){this.renderParamsResevation.push([e,t])}get(e){return this.adSlots.get(e)}getAll(){return Array.from(this.adSlots.values())}getBy(e=()=>!0){return this.getAll().filter(e)}applyReservedParams(){this.renderParamsResevation.forEach(e=>{let t=this.adSlots.get(e[0]);!t||t.updateRenderParams(e[1])})}};var E=class{static get pubadsReady(){return this.gpt.pubadsReady}static get pubads(){return this.gpt.pubads()}static get isInitialLoadDisabled(){return this.pubads.isInitialLoadDisabled()}static get gpt(){return window.googletag}static get _cmd(){return this.gpt.cmd}static loadGptJs(){window.googletag=window.googletag||{},window.googletag.cmd=window.googletag.cmd||[],this.gpt.apiReady||!!document.querySelector("script[src$='gpt.js']")||document.head.appendChild(y("script",{src:"https://securepubads.g.doubleclick.net/tag/js/gpt.js",async:"true"})),this._cmd.push(()=>{this.pubads.getSlots().length===0&&(this.pubads.disableInitialLoad(),this.pubads.enableSingleRequest()),this.gpt.enableServices()})}static filterSlots(e){return this.pubads.getSlots().filter(e)}static getSlots(){return this.pubads.getSlots()}static addEventListenerOnce(...e){if(e[0]==="slotOnload"){let[t,r]=e,n=i=>{r(i)&&this.pubads.removeEventListener(t,n)};this.pubads.addEventListener(t,n)}else if(e[0]==="slotRenderEnded"){let[t,r]=e,n=i=>{r(i)&&this.pubads.removeEventListener(t,n)};this.pubads.addEventListener(t,n)}}static addEventListener(...e){switch(e[0]){case"slotOnload":this.pubads.addEventListener(e[0],e[1]);return;case"slotRenderEnded":this.pubads.addEventListener(e[0],e[1]);return;default:return}}static destroyGamSlots(e){return this.gpt.destroySlots(e)}static defineGamSlot(e,t,r){try{return this.gpt.defineSlot(e,t,r)}catch(n){return null}}static defineGamInterstitialSlot(e){try{return this.gpt.defineOutOfPageSlot(e,this.gpt.enums.OutOfPageFormat.INTERSTITIAL)}catch(t){return null}}static displayGamSlot(e){return this.gpt.display(e.getSlotElementId())}static setTargeting(e,t){this._cmd.push(()=>{this.pubads.setTargeting(e,t)})}static setTargetingForPubadsPromise(e,t){return new Promise(r=>{this._cmd.push(()=>{Array.isArray(e)?e.forEach(n=>{this.pubads.setTargeting(n,t)}):this.pubads.setTargeting(e,t),r(!0)})})}static setPublisherProvidedId(e){this._cmd.push(()=>{this.pubads.setPublisherProvidedId(e)})}static onPubadsReady(r){return g(this,arguments,function*(e,t=xo){if(e&&typeof e!="function")throw new Error("invalid callback");return new Promise((n,i)=>{let s,a=()=>{if(window.cancelAnimationFrame(s),!this.pubadsReady){s=window.requestAnimationFrame(a);return}window.clearTimeout(d),this._cmd.push(()=>{try{let c=e();n(c)}catch(c){i(c)}})},d=window.setTimeout(()=>{window.cancelAnimationFrame(s),window.clearTimeout(d),i(new Error("timedout"))},t);a()})})}static getGAMIframe(e){return document.querySelector(`div[id="${e}"] > div > iframe`)}};var yi=class{constructor(e,t){this.o=e;this.p=t;this._original=this.o[this.p],this.descriptor=Object.getOwnPropertyDescriptor(this.o,this.p),this.jacked=null}get original(){return this._original}jack(e){return this.jacked=Object.defineProperty(this.o,this.p,v(u({},this.descriptor),{value:e}))[this.p],this.jacked}unjack(){return Object.defineProperty(this.o,this.p,v(u({},this.descriptor),{value:this.original})),this.jacked=null,this.original}jackOnce(e){return this.jacked?this.jacked:this.jack(e)}},Ei=()=>new yi(E.pubads,"refresh");var Va=30,Br=class{get isSingleRequestEnabled(){return this._isSingleRequestEnabled}constructor(){this.name="GamSlotProtector",this._slots=new Set,this.queue=[],this.queueForJacker=[],this.isInitiated=!1,this.refreshJacker=null,this.isBeforeFirstRefresh=!0,this._isSingleRequestEnabled=!1,this.gamConfig=on(Ho),E.loadGptJs()}setGamConfig(e){this.gamConfig=F(this.gamConfig,e)}get slots(){return Array.from(this._slots)}getGamSlotByDivId(e){return this.slots.find(t=>t.getSlotElementId()===e)}enableSingleRequest(){this.forceInternalRequest(),this._isSingleRequestEnabled=!0,l.log(this.name,"enable single request")}init(e){return g(this,null,function*(){return E.onPubadsReady(()=>{l.log(this.name,"init on pubads ready"),this._slots=new Set(this.pullInitialGamSlots(e));let t=E.getSlots().length===this.slots.length;this.execQueue(this.queue),e.forEach(n=>{if(n.renderParams.formatSpec.id===h.MULTIPLEX){n.renderParams.formatSpec.params.infeedSlots.forEach(i=>{i.hasStoppedGamTraffic?this.safeDestroyGamSlot(i):this.safeDefineGamSlot(i)});return}n.hasStoppedGamTraffic?this.safeDestroyGamSlot(n):this.pickOrRedefineSlot(n)});let r=e.filter(n=>!n.hasStoppedGamTraffic&&(n.renderParams.isGamSlotExists||n.renderParams.isPassback));this.gamConfig.singleRequest&&t&&r.length<=Va&&this.enableSingleRequest(),this.refreshJacker=Ei(),this.isInitiated=!0,this.execQueue(this.queueForJacker)}).catch(b)})}requestSlots(e){this.queue.push(e),this.isInitiated&&this.execQueue(this.queue)}requestSlotsPromise(){return new Promise(e=>this.requestSlots(t=>e(t)))}safeDestroyGamSlot(e){let t=this.getGamSlotByDivId(e.divId);if(!t)return!0;let r=t.getTargetingMap();return this._slots.delete(t),e.updateRenderParams({isGamSlotExists:!1,targeting:r}),E.destroyGamSlots([t])}safeDefineGamSlot(e){let t=e.tag;if((t==null?void 0:t.adServer)!==de)return null;let{slotPath:r,slotSizes:n}=t;try{let i=E.defineGamSlot(r,n,e.divId);return i?(this._slots.add(i),e.updateRenderParams({isGamSlotExists:!0}),i):null}catch(i){return null}}safeDefineGamInterstitialSlot(e){var r;if(((r=e.tag)==null?void 0:r.adServer)!==de)return null;let t=e.tag.slotPath;try{let n=E.defineGamInterstitialSlot(t);return n?(this._slots.add(n),e.updateRenderParams({isGamSlotExists:!0}),n):null}catch(n){return null}}safeRequestAdsInner(e){return g(this,null,function*(){return e.forEach(t=>t.addService(E.pubads)),e.forEach(t=>E.displayGamSlot(t)),this.execExplicitRefresh(e)})}safeRequestAds(e){let t=e.map(r=>this.slotOnLoadPromise(r));return this.safeRequestAdsInner(e),t}pickOrRedefineSlot(e){var s;if(((s=e.tag)==null?void 0:s.adServer)!==de)return null;let t=this.getGamSlotByDivId(e.divId),r=(t==null?void 0:t.getAdUnitPath())===e.adUnitPath,n=e.renderParams.isPassback,i=a=>(this.safeDestroyGamSlot(a),this.safeDefineGamSlot(a));return t?r?(this.notifySlotExistance(e,!0),t):i(e):n?this.safeDefineGamSlot(e):(this.notifySlotExistance(e,!1),null)}pullInitialGamSlots(e){let t=e.map(r=>r.divId);return E.filterSlots(r=>t.includes(r.getSlotElementId()))}notifySlotExistance(e,t){e.updateRenderParams({isGamSlotExists:t})}slotOnLoadPromise(e,t,r){return new Promise(n=>{E.addEventListenerOnce("slotOnload",i=>i.slot!==e?!1:(T.postMessage({type:R.RENDERED,divId:e.getSlotElementId(),adUnitPath:e.getAdUnitPath(),adServer:"gam"}),t?t.call(r!=null?r:null,i)&&n():n(),!0))})}slotRenderEndedPromise(e,t,r){return new Promise(n=>{E.addEventListenerOnce("slotRenderEnded",i=>i.slot!==e?!1:(t?t.call(r!=null?r:null,i)&&n():n(),!0))})}execExplicitRefresh(e){let t=E.isInitialLoadDisabled&&(!this.isSingleRequestEnabled||this.isBeforeFirstRefresh)?e:e.filter(r=>this.hasRefreshKeyValue(r.getTargetingMap()));return this.isBeforeFirstRefresh=!1,l.log(this.name,"explicitly refresh",t.map(r=>r.getSlotElementId())),t.length>0?E.onPubadsReady(()=>{var r;(r=this.refreshJacker)==null||r.original(t)}):Promise.resolve()}forceInternalRequest(){return g(this,null,function*(){this.queueForJacker.push(()=>{var e;(e=this.refreshJacker)==null||e.jackOnce((t,r)=>g(this,null,function*(){var s;let n=yield this.requestSlotsPromise(),i=a=>!n.includes(a);(s=this.refreshJacker)==null||s.original(t?t.filter(i):E.filterSlots(i),r)}))}),this.isInitiated&&this.execQueue(this.queueForJacker)})}abortAllSlots(){return g(this,null,function*(){return E.destroyGamSlots(yield this.requestSlotsPromise())})}hasRefreshKeyValue(e){var t,r;return!!((t=e[or])==null?void 0:t.includes(Oe))||!!((r=e[nr])==null?void 0:r.includes(ir))}execQueue(e){for(;e.length;){let t=e.shift();try{t(this.slots)}catch(r){b}}}};var Hr=class{constructor(e,t){this.adSlotService=e;this.refresher=t}registerPassback(e){l.log("register passback for",e),this.refresher.resetPrevention(e);let t=this.adSlotService.get(e);t?t.updateRenderParams({isPassback:!0}):this.adSlotService.reserveRenderParams(e,{isPassback:!0}),this.refresher.prevent(e)}passback(...[e,t,r]){var a;l.log("applying passback for",e,"->",t);let n=this.adSlotService.get(e),i=(a=this.safeQuerySelector(t))!=null?a:document.getElementById(t);if(!n)throw new Error("Slot not found.");if(!i)throw new Error("Passback target not found.");if(n.renderParams.isApplied)throw new Error("Passback is already executed.");if(!n.renderParams.isPassback)throw new Error("applyPassback is called before RegisterPassback.");i.innerHTML="",i.appendChild(y("div",{id:e})),this.refresher.permit(e);let s=r?dr.PASSBACK:dr.DIRECT;n.updateRenderParams({isApplied:!0,targeting:{[Zo]:s}}),Tn(e,n.settings.code)}applyPassback(e,t,r=!1){try{this.passback(e,t,r)}catch(n){if(l.errorLog(n),!(n instanceof Error))return;_n(e,n.message)}}rerun(){this.adSlotService.getAll().forEach(e=>e.updateRenderParams({isApplied:!1,targeting:Wo}))}safeQuerySelector(e){let t=null;try{t=document.querySelector(e)}catch(r){}return t}};var Si=class{constructor(e,t){this.adSlotsService=e;this.events=t;this.name="Recoverer",this.controllerStore=new Map}init(){this.events.on(p.Recoverer.recover,e=>this.recover(e)),this.subscribeCarpetMessageToRecover(),this.controllerStore=this.initControllerStore()}recover(e){let{adSlots:t}=e;t.forEach(r=>{let n=this.controllerStore.get(r.divId);!n||n.recover()})}subscribeCarpetMessageToRecover(){T.addMessageListener(R.CLOSED,e=>{this.events.emit(p.Recoverer.recover,t=>t.divId===e.data.slotDiv)})}initControllerStore(){return new Map(this.adSlotsService.getAll().map(e=>[e.divId,new Ai(e,this.events)]))}},Ai=class{constructor(e,t){this.adSlot=e;this.events=t;this.name="RecoveryCounter",this.count=0,this.config=this.adSlot.settings.recovery}recover(){return this.canRecover()?this.permit():!1}permit(){var e;return this.config?(setTimeout(()=>{this.events.emit(p.Refresher.recovery,t=>t.divId==this.adSlot.divId)},this.config.duration),this.increament(),l.log(this.name,`recover ads for divId "${this.adSlot.divId}" after ${(e=this.config)==null?void 0:e.duration} ms`),!0):!1}canRecover(){let e=this.adSlot.settings.recovery;return(e==null?void 0:e.use)?this.count<e.count:!1}increament(){var e,t;this.count++,l.log(this.name,`increament count for divId "${this.adSlot.divId}".`,`remaining count: ${(t=(e=this.config)==null?void 0:e.count)!=null?t:0-this.count}`)}},bi=Si;var Nt=class{constructor(){this.name="default"}create(e){return e}migrate(e,t){return N(t),t}onload(e){return e.style.display="block",!0}get hooks(){return{onload:this.onload.bind(this)}}};var Ur=class{constructor(){this.name="expandBanner",this.teardownFn=null}create(e){return e}before(e,t){var r;return(r=this.teardownFn)==null||r.call(this),!0}migrate(e,t){return N(t),t.style.visibility="hidden",t}onload(e){return e.style.display="block",e.style.width="max-content",this.teardownFn=Wa(this.expand.bind(this),[e]),!0}get hooks(){return{before:this.before.bind(this),onload:this.onload.bind(this)}}expand(e){za(e),e.style.visibility="visible"}},za=o=>{var e;try{let t=1.5,r=o.clientWidth,n=o.clientHeight,s=Math.min(((e=window.top)==null?void 0:e.innerWidth)||Number.MAX_SAFE_INTEGER,document.documentElement.clientWidth)/r||1;if(s<=1)return;s<=t&&(qa(o,s),$a(o,s,n))}catch(t){}},qa=(o,e)=>{o.style.transformOrigin="center center",o.style.transform=`scale(${e})`},$a=(o,e,t)=>{let r=15,n=t*(e-1)/2+r;o.style.margin=`${n}px auto`},Wa=(o,[e])=>(e.clientHeight>1&&o(e),Z(e,()=>{e.clientHeight>1&&o(e)}));var kr=class{constructor(){this.name="interstitial"}create(e){return e}};var q=class{constructor(){this.name="overlayNoCloseFormat",this.teardownFns=[]}create(e){let t=y("ins",{id:U,style:"display:inline-block;position:relative;margin:auto;"}),r=y("ins",{id:C,style:`position:fixed;display:inline-block;text-align:center;line-height:0;bottom:0px;left:0px;right:0px;margin:auto;z-index:${Y.OVERLAY};opacity:0;`},t);return N(r),e.appendChild(r),e}before(e,t){var r;for(;this.teardownFns.length>0;)(r=this.teardownFns.shift())==null||r();return!0}migrate(e,t){let r=e.getElementById(U);if(!r)throw new Error("overlay format broken");t.style.width="",t.style.height="",r.appendChild(t);let n=document.getElementById(C);return n&&n.remove(),document.body.appendChild(e),t.style.display="inline-block",t}get hooks(){return{before:this.before.bind(this),onload:this.onload.bind(this)}}onload(e){try{let t=document.getElementById(C);if(!t)throw new Error("no ad rendered");return e.style.display="inline-block",this.teardownFns.push(Lt(this.adjustOverlayOuter.bind(this),[e,t])),!0}catch(t){return!1}}adjustOverlayOuter(e,t){t.style.width=`${e.clientWidth}px`,le(e,t)}};var Ue=class extends q{constructor(){super();this.levitate=null,this.isMessageReceiverSet=!1}get hooks(){return v(u({},super.hooks),{after:this.after.bind(this)})}after(e,t){return e?(this.addMessageReceiver(),!!t):!1}addMessageReceiver(){this.isMessageReceiverSet||(window.addEventListener("message",e=>{var t;((t=e==null?void 0:e.data)==null?void 0:t.type)===He&&this.applyLevitate()}),this.isMessageReceiverSet=!0)}applyLevitate(){this.levitate||(this.levitate=new z),this.levitate.apply(),this.levitate.upsertBootEl()}};var ce=class extends q{constructor(){super();this.name="overlayFormat"}create(e){let r=super.create(e).getElementById(C);if(!r)throw new Error("format creation failed");return pi(r),e}get hooks(){return{before:super.before.bind(this),after:this.after.bind(this),onload:this.onload.bind(this)}}after(e,t){let r=e.getElementById(C),n=e.getElementById(V);if(!r||!n)throw new Error(ne);return Ot(n,t.id),Mt(n,t.id),this.teardownFns.push(xt(n,t.id)),!0}onload(e){let t=document.getElementById(C);return t?(e.style.display="inline-block",this.teardownFns.push(Lt(this.expand.bind(this),[e,t])),!0):!1}expand(e,t){mi(t,e),le(e,t)}};var Gr=class extends Ue{constructor(){super();this.overlay=new ce}create(e){return this.overlay.create(e)}get hooks(){return{after:this.after.bind(this),onload:this.onload.bind(this)}}after(e,t){var r;return(r=super.after)==null||r.call(this,e,t),this.overlay.after(e,t)}onload(e){return this.overlay.onload(e)}};var ke=class extends ce{constructor(){super();this.levitate=new z}get hooks(){return v(u({},super.hooks),{onload:this.onload.bind(this)})}onload(e){return this.levitate.apply(),super.onload(e)}};var Vr=class extends ke{constructor(){super()}onload(e){return this.levitate.upsertBootEl(),super.onload(e)}};var zr=class extends q{constructor(){super();this.levitate=new z}get hooks(){return v(u({},super.hooks),{onload:this.onload.bind(this)})}onload(e){return this.levitate.apply(),this.levitate.upsertBootEl(),super.onload(e)}};var Ge=class{constructor(){this.name="overlayConfigurableFormat",this.customizers=[],this.tearDownResizeObserver=null,this.isStyleInserted=!1}insertStyleOnce(){this.isStyleInserted||(M([`#${U} {
        display: flex;
        flex-direction: row;
        align-items: flex-start;
        flex-wrap: wrap;
        margin: auto;
        background-color: transparent;
      }`,`#${C} {
        position: fixed;
        display: inline-block;
        line-height: 0;
        text-align: center;
        left: 0px;
        right: 0px;
        margin: auto;
        z-index: ${Y.OVERLAY};
        opacity: 0;
        width: 100vw;
        box-sizing: border-box;
        background-color: transparent;
      }`]),this.isStyleInserted=!0)}static createFlexOVWrapper(){let e=y("ins",{id:U});e.style.textDecoration="none";let t=y("ins",{id:C,style:"bottom:0px;"},e);return t.style.textDecoration="none",N(t),{inner:e,outer:t}}setParams(e,t){t&&"bgColor"in t&&"useHeaderOV"in t?this.customizers=Dr(t):this.customizers=Dr(Dt(h.CUSTOM_OV).params)}create(e){let{inner:t,outer:r}=Ge.createFlexOVWrapper();return e.appendChild(r),this.customizers.reduce((n,i)=>i.create?i.create(r,t)&&n:n,!1),e}get hooks(){return{before:this.before.bind(this),after:this.after.bind(this),onload:this.onload.bind(this)}}before(e,t){var r;return(r=this.tearDownResizeObserver)==null||r.call(this),this.insertStyleOnce(),!0}migrate(e,t){let r=e.getElementById(U);if(!r)throw new Error("overlay format broken");t.style.width="",t.style.height="",r.appendChild(t);let n=document.getElementById(C);return n&&n.remove(),document.body.appendChild(e),t}after(e,t){return this.customizers.reduce((n,i)=>i.after?i.after(e,t)&&n:n,!0)}onload(e){let t=document.getElementById(C),r=document.getElementById(U);return!t||!r?!1:(this.customizers.forEach(n=>{var i;return(i=n.onload)==null?void 0:i.call(n,e,t,r)}),e.clientHeight>1&&le(e,t),this.tearDownResizeObserver=Z(e,()=>{this.customizers.forEach(n=>{var i;return(i=n.onResize)==null?void 0:i.call(n,e,t,r)}),e.clientHeight>1&&le(e,t)}),!0)}};var qr=class{constructor(){this.name="infeed"}create(e){return e}migrate(e,t){return N(t),t}onload(e){return e.style.display="block",!0}get hooks(){return{onload:this.onload.bind(this)}}};var $r=class{apply(e,t){e.style.position="absolute",e.style.transformOrigin="top left"}cancel(e,t){}};var Ti=class{constructor(e,t,r={px:0},n={px:0},i=[0]){this.target=e;if(!IntersectionObserver){this.observer=null;return}let s=this.createScrollIntersectWatcher(),a=this.passOnlyOnChange(t),d=_=>_.forEach(D=>a(s(D))),c="px"in r?`${r.px}px`:`${r.pct}%`,f="px"in n?`${n.px}px`:`${n.pct}%`,S={root:null,rootMargin:`${c} 100px ${f}`,threshold:i};this.observer=new IntersectionObserver(d,S),this.observer.observe(this.target)}disconnect(){var e,t;(e=this.observer)==null||e.unobserve(this.target),(t=this.observer)==null||t.disconnect()}passOnlyOnChange(e){let t=null;return r=>{(t===null||r.status!==t.status||r.isOnBoundary!==t.isOnBoundary)&&e(r),t=u({},r)}}createScrollIntersectWatcher(){let e=0,t=Number.MIN_VALUE;return r=>{let n=r.boundingClientRect.y,i=r.intersectionRatio,s=n>e?"down":"up",a=i>=t?"In":"Out";return e=n,t=i,{target:r.target,status:`${s}${a}`,isOnBoundary:0<i&&i<1}}}},Ve=Ti;var ze={WRAPPER:"geniee_inpage_wrapper",INNER:"geniee_inpage_inner",DEFAULT_SCALE:1},A={WRAPPER:"bl_gnsinpage",MIDDLE:"bl_gnsinpage-middle",INNER:"bl_gnsinpage_inner",AD:"gnsinpage__ad",AD_TOP:"ly_gnsinpage_ad--top",AD_BOTTOM:"ly_gnsinpage_ad--bottom"},L={INPAGE:"--gn-inpage-btn-sz",INPAGE_TOP:"--gn-inpage-btn-top-sz",INPAGE_BOTTOM:"--gn-inpage-btn-bottom-sz"},qe="--gn-inpage-scale",Bt="--gn-inpage-width",pe="--gn-inpage-height",ee={FOLD:"inpage-fold"},te={INPAGE:0,CANCELED:1,VH_BANNER:2},me={CANCEL:"CptCancelInpage",YAHOO:"CptAsyncYahooApplyIngape"},Wr=50,Ri=-25;var $e=class{constructor(){this.tearDownFns=new Map}static createCallback(e){return t=>{switch(t.status){case"upIn":case"downIn":e.classList.remove(A.AD_BOTTOM,A.AD_TOP);return;case"upOut":e.classList.remove(A.AD_BOTTOM),e.classList.add(A.AD_TOP);return;case"downOut":e.classList.add(A.AD_BOTTOM),e.classList.remove(A.AD_TOP);return;default:return}}}apply(e,{wrapper:t}){var n;e.classList.add(A.AD);let r=new Ve(t,$e.createCallback(e),{px:0},{px:0},[1]);return(n=this.tearDownFns.get(e.id))==null||n(),this.tearDownFns.set(e.id,()=>{r.disconnect()}),!0}cancel(e,t){var r;(r=this.tearDownFns.get(e.id))==null||r(),this.tearDownFns.delete(e.id),e.classList.remove(A.AD,A.AD_TOP,A.AD_BOTTOM)}};var We=class{constructor(){this.tearDownFns=new Map}static insertRulesOnce(){this.VHStyleRules.length>0&&(M(this.VHStyleRules),this.VHStyleRules=[])}static createViewportCallback(e,t){return r=>{switch(r.status){case"upIn":case"downIn":e.classList.remove(A.AD_TOP,A.AD_BOTTOM);return;case"upOut":e.classList.add(A.AD_TOP);return;case"downOut":e.classList.add(A.AD_BOTTOM),t();return;default:return}}}static createUnfoldCallback(e){return t=>{switch(t.status){case"upIn":e();return;default:return}}}apply(e,{wrapper:t,inner:r}){var c,f;We.insertRulesOnce(),e.classList.add(A.AD);let n=(c=document.getElementById(`inpage_wbtn_${e.id}`))==null?void 0:c.firstElementChild,i=()=>{t.classList.add(ee.FOLD),r.classList.add(ee.FOLD),n==null||n.classList.add(ee.FOLD)},s=()=>{t.classList.remove(ee.FOLD),r.classList.remove(ee.FOLD),n==null||n.classList.remove(ee.FOLD)},a=new Ve(t,We.createViewportCallback(e,i),{px:Wr},{px:Wr},[0]),d=new Ve(t,We.createUnfoldCallback(s),{px:0},{pct:Ri},[0]);return(f=this.tearDownFns.get(e.id))==null||f(),this.tearDownFns.set(e.id,()=>{a.disconnect(),d.disconnect()}),!0}cancel(e,t){}},Ht=We;Ht.VHStyleRules=[`.${ee.FOLD} {
        height: 0px !important;
    }`];var Yr=class{createCloseButton(e,t){let r=document.createElement("template"),n=`<div
      id="${e}"
      role="button"
      class="inpageCloseWrap ${t}"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 512 512"
        width="16"
        height="16"
      >
        <g>
          <polygon
           points="512,52.535 459.467,0.002 256.002,203.462 52.538,0.002 0,52.535 203.47,256.005 0,459.465 52.533,511.998 256.002,308.527 459.467,511.998 512,459.475 308.536,256.005"
           style="fill: #000; stroke: #000; stroke-width: 10px;"
          ></polygon>
        </g>
      </svg>
    </div>`;return r.insertAdjacentHTML("beforeend",n),r.children[0]}insertRules(e,t){let r=e.querySelector(`.${A.INNER}`),n=(r==null?void 0:r.getBoundingClientRect().left)||0,i=window.innerWidth-((r==null?void 0:r.getBoundingClientRect().right)||0),s="position: absolute; top: 0;",a="position: absolute; bottom: 0;",d="position: fixed; top: 0;",c="position: fixed; z-index: 1; bottom: 0;";M([`#${e.id} .inpageCloseWrap svg{
        vertical-align: ${t.indexOf("top")>0?"top":"bottom"};
        line-height: var(${L.INPAGE}, 16px);
      }`,`#${e.id} .inpageCloseWrap.position_left_top {
        ${s} left: 0;
      }`,`#${e.id} .inpageCloseWrap.position_right_top {
        ${s} right: 0;
      }`,`#${e.id} .inpageCloseWrap.position_left_bottom {
        ${a} left: 0;
      }`,`#${e.id} .inpageCloseWrap.position_right_bottom {
        ${a} right: 0;
      }`,`#${e.id} .inpageCloseWrap.position_left_top_inner {
        ${d} left: ${n}px;
      }`,`#${e.id} .inpageCloseWrap.position_right_top_inner {
        ${d} right: ${i}px;
        z-index: 2;
      }`,`#${e.id} .inpageCloseWrap.position_left_bottom_inner {
        ${c} left: ${n}px;
      }`,`#${e.id} .inpageCloseWrap.position_right_bottom_inner {
        ${c} right: ${i}px;
        z-index: 2;
      }`])}createButtonPosition(e){let t="position_left_top";switch(e){case 1:break;case 2:t="position_right_top";break;case 3:t="position_left_bottom";break;case 4:t="position_right_bottom";break;default:}return t}migrate(e,t,r){let{wrapper:n,middle:i,inner:s}=e,a=this.createButtonPosition(r);this.insertRules(n,a);let d=this.createCloseButton(`inpage_wbtn_${t}`,a),c=`${a}_inner`,f=this.createCloseButton(`inpage_ibtn_${t}`,c);switch(i.insertAdjacentElement("afterbegin",d),r){case 3:case 4:I(n,L.INPAGE_BOTTOM,"16px"),s.style.bottom="16px";break;default:I(n,L.INPAGE_TOP,"16px"),s.style.top="16px"}s.insertAdjacentElement("afterbegin",f);let S=()=>{n.style.display="none"};return d.addEventListener("click",S),I(n,L.INPAGE,"16px"),f.addEventListener("click",S),!0}onResize({wrapper:e},t){let r=this.createButtonPosition(t),n=e.querySelector(`#${e.id} .inpageCloseWrap.${r}`),i=e.querySelector(`#${e.id} .inpageCloseWrap.${r}_inner`);if(!n||!i)return!1;let s=e.querySelector(`.${A.INNER}`);if(r.includes("right")){let a=window.innerWidth-((s==null?void 0:s.getBoundingClientRect().right)||0);i.style.right=`${a}px`,n.style.right="0px"}else{let a=(s==null?void 0:s.getBoundingClientRect().left)||0;i.style.left=`${a}px`,n.style.left="0px"}return!0}onload(e,t){return this.onResize(e,t)}cancel(e,t=!1){var i,s;let r=[L.INPAGE_BOTTOM,L.INPAGE_TOP];(i=document.getElementById(`inpage_ibtn_${e}`))==null||i.remove(),t||(r.push(L.INPAGE),(s=document.getElementById(`inpage_wbtn_${e}`))==null||s.remove());let n=document.getElementById(e);return n&&ln(n,...r),!0}};var je=class{static get viewportHeight(){return this._MIN_VIEWPORT_HEIGHT=Math.min(this._MIN_VIEWPORT_HEIGHT,window.innerHeight-10),this._MIN_VIEWPORT_HEIGHT}tryExpand(e,t){try{if(e.clientWidth<1)return!1;let r=t.querySelector(".inpageCloseWrap")?16:0,n=Math.min(je.MAX_EXPAND_SCALE,t.clientWidth/e.clientWidth),i=e.clientHeight*n>je.viewportHeight-r?(je.viewportHeight-r)/e.clientHeight:n;return t.style.setProperty(qe,`${i}`),!0}catch(r){return!1}}onload(e,t){return this.onResize(e,t)}onResize({wrapper:e},t){return this.tryExpand(t,e)}},Ye=je;Ye.MAX_EXPAND_SCALE=1.5,Ye._MIN_VIEWPORT_HEIGHT=Number.MAX_SAFE_INTEGER;var jr=class{constructor(e,t,r){this.applier=e;this.isExpandable=t;this.closeBtn=r;this.resizeFns=[],this.teardownFn=null}clearOnResize(){this.resizeFns=[]}cancelCloseButtn(){this.closeBtn=void 0}addOnResize(e){this.resizeFns.push(e)}createResizeObserver(e){this.teardownFn=Z(e,()=>{this.resizeFns.forEach(t=>t())})}teardownResizeObserver(){var e;(e=this.teardownFn)==null||e.call(this),this.teardownFn=null,this.clearOnResize()}setApplier(e){this.applier=e,this.isCanceled&&(this.closeBtn=void 0)}get currentApplier(){return this.applier}get isInPage(){return this.applier===te.INPAGE}get isCanceled(){return this.applier===te.CANCELED}get isVHBanner(){return this.applier===te.VH_BANNER}};var $=class{constructor(e,t){this.yAdHelper=e;this.option=t;this.name="inPageFormat",this.appliers=[new $e,new $r,new Ht],this.states=new Map,this.closeBtn=new Yr,this.expander=new Ye,this.setReceiveCancelMessageEvent(),this.yAdHelper=e,M([`.${A.WRAPPER} {
        position: relative;
        margin: auto;
        width: calc(100% - 1px);
        max-width: calc(100vw - 1px);
        height: calc(var(${pe}, auto) + var(${L.INPAGE}, 0px));
      }`,`.${A.MIDDLE} {
        position: absolute;
        inset: 0;
        margin: 0 auto;
        width: var(${Bt}, 100%);
        height: calc(var(${pe}, auto) + var(${L.INPAGE}, 0px));
      }`,`.${A.INNER} {
        clip: rect(0, auto, auto, 0);
        position: absolute;
        inset: 0;
        margin: 0 auto;
        width: var(${Bt}, 100%);
        height: calc(var(${pe}, auto));
      }`,`.${A.AD} {
        transform: translate3d(0, 0, 0);
        position: absolute;
        inset: auto;
        transform-origin: top left;
        display: block !important;
        margin: 0 !important;
      }`,`.${A.AD_TOP} {
        position: fixed !important;
        top: var(${L.INPAGE_TOP}, 0px);
      }`,`.${A.AD_BOTTOM} {
        position: fixed !important;
        bottom: var(${L.INPAGE_BOTTOM}, 0px);
        transform-origin: bottom left;
      }`])}static getWrapperId(e){return`${ze.WRAPPER}_${e}`}static getInnerId(e){return`${ze.INNER}_${e}`}static getWrappers(e,t){let r=t.getElementById(this.getWrapperId(e)),n=r==null?void 0:r.querySelector(`.${A.MIDDLE}`),i=t.getElementById(this.getInnerId(e));if(!r||!n||!i)throw new Error("inpage format broken");return{wrapper:r,middle:n,inner:i}}setReceiveCancelMessageEvent(){window.addEventListener("message",e=>{var n;if(((n=e.data)==null?void 0:n.type)!==me.CANCEL)return;let t=String(e.data.slotDiv),r=document.getElementById(t);!r||!(r instanceof HTMLDivElement)||this.cancel(r)})}setParams(e,t){var a,d;let r=((a=this.option)==null?void 0:a.viewHackBannerMode)?$.VH_BANNER_PARAMS:t;if(!r)return;let n="useExpansion"in r&&r.useExpansion,i="closeButton"in r?r.closeButton:void 0,s=((d=this.option)==null?void 0:d.viewHackBannerMode)?te.VH_BANNER:te.INPAGE;this.states.set(e,new jr(s,n,i==null?void 0:i.position))}create(e){let t=document.createElement("template"),r=`
      <div
        class="${A.WRAPPER}"
        id="${ze.WRAPPER}__tmp"
        style="visibility: hidden"
        data-${ve}=""
      >
        <div class="${A.MIDDLE}">
          <div
            class="${A.INNER}"
            id="${ze.INNER}__tmp"
            style="clip: rect(0px,auto,auto,0px); position: absolute; inset: 0px; margin: auto;"
          ></div>
        </div>
      </div>`;return t.insertAdjacentHTML("beforeend",r),e.appendChild(t.children[0]),e}migrate(e,t){if(!t.parentElement)throw new Error("there is no div matched");let r=this.states.get(t.id);if(!r)throw new Error("there is no inpage state for div");let{wrapper:n,middle:i,inner:s}=$.getWrappers("_tmp",e);return t.textContent="",n.id=$.getWrapperId(t.id),s.id=$.getInnerId(t.id),I(n,L.INPAGE,"0px"),r.isExpandable||(t.style.overflow="hidden"),t.parentElement.insertBefore(e,t),s.appendChild(t),n.style.setProperty(qe,"1"),r.closeBtn!==void 0&&this.closeBtn.migrate({wrapper:n,middle:i,inner:s},t.id,r.closeBtn),t}get hooks(){return{before:this.before.bind(this),onload:this.onload.bind(this)}}before(e,t){let r=document.getElementById($.getWrapperId(t.id));return r&&(r.insertAdjacentElement("beforebegin",t),r.remove()),this.cancel(t),!0}adjustWrapper(e){let{adEl:t,wrapper:r,height:n}=e;return I(r,Bt,`${Math.floor(t.getBoundingClientRect().width)}px`),I(r,pe,`${n!=null?n:Math.floor(t.getBoundingClientRect().height)}px`),!0}apply(e,t){var d;let r=e.id,n=$.getWrappers(r,document),i=(d=e.querySelector("iframe[data-aladdin-format='true']"))!=null?d:e.querySelector("div > iframe");if(!i)return!1;e.removeAttribute("style"),t.isExpandable&&(e.style.transform=`scale(var(${qe}, 1)) translate3d(0,0,0)`,this.expander.onload(n,i),t.addOnResize(()=>{this.expander.onResize(n,i)})),this.appliers[t.currentApplier].apply(e,n),t.isVHBanner&&t.closeBtn&&this.closeBtn.cancel(r,!0);let s={adEl:i,wrapper:n.wrapper},a=()=>{this.adjustWrapper(s),t.closeBtn&&this.closeBtn.onResize(n,t.closeBtn),this.yAdHelper.isYahooRendered(r)&&this.yAdHelper.applyYahooAdjustments(n,e,r,t.closeBtn,this.closeBtn)};return a(),t.addOnResize(a),n.wrapper.style.visibility="visible",t.createResizeObserver(i),!0}onload(e){try{let t=this.states.get(e.id);return t&&!t.isCanceled?this.apply(e,t):!!(t==null?void 0:t.isCanceled)}catch(t){return!1}}cancel(e){var n;let t=this.states.get(e.id);if(!t||t.isCanceled)return!!(t==null?void 0:t.isCanceled);let r=(n=document.getElementById($.getWrapperId(e.id)))!=null?n:void 0;return this.appliers[t.currentApplier].cancel(e,r),t.teardownResizeObserver(),r?(t.isVHBanner?t.cancelCloseButtn():t.setApplier(te.CANCELED),this.closeBtn.cancel(e.id),this.apply(e,t)):!0}},Ke=$;Ke.VH_BANNER_PARAMS={useExpansion:!0,closeButton:{position:O.UPPER_LEFT},excludeAladdin:!0};var Kr=class{constructor(){this.yadIds=new Set;this.adUnitCodes=new Map;this.recieveAdUnitForBidInfo(),this.recieveYadFromAladdin()}recieveYadFromAladdin(){window.addEventListener("message",e=>{var r,n;if(((r=e.data)==null?void 0:r.type)!==me.YAHOO)return;let t=(n=e.data)==null?void 0:n.divId;!t||this.yadIds.add(t)})}recieveAdUnitForBidInfo(){T.addMessageListener(R.RENDERED,e=>{try{return this.adUnitCodes.set(e.data.divId,e.data.adUnitPath),!0}catch(t){return l.errorLog(t),!1}})}isYahooRendered(e){let t=this.adUnitCodes.get(e);if(!t)return!1;let r=cn(t,Kr.APPNEXUS);return this.yadIds.has(e)||r}applyYahooAdjustments(e,t,r,n,i){let s=70;t.style.padding=`${s}px 0`,I(e.wrapper,pe,`${Math.floor(t.getBoundingClientRect().height)}px`),n&&i.cancel(r)}},Ut=Kr;Ut.APPNEXUS="appnexus";var wi=o=>!!o&&"infeedParams"in o;var Qr=class{constructor(){let e=1;this.name="MultiplexFormat",this.infeedDivIds=[],this.columns=e}create(e){return e}setParams(e,t){wi(t)&&(this.infeedDivIds=t.infeedParams.map(r=>r.slotDiv),this.columns=t.numColumns)}before(e,t){return this.composeInnerElms(t),!0}get hooks(){return{before:this.before.bind(this)}}migrate(e,t){let r=5,n={display:"grid",rowGap:`${r}px`,gridTemplateColumns:new Array(this.columns).fill("1fr").join(" "),marginTop:`${r}px`,marginBottom:`${r}px`};return Object.assign(t.style,n),t}composeInnerElms(e){this.infeedDivIds.forEach(t=>{e.appendChild(y("div",{id:t}))})}};var Ii=new Ut,_i=()=>new Map([[h.DEFAULT,new Nt],[h.OV,new ce],[h.OV_NO_CLOSE,new q],[h.OV_IPHONE_UPPERBASE,new ke],[h.OV_IPHONE_UPPERBASE_BOOT,new Vr],[h.INTERSTITIAL,new kr],[h.OV_IPHONE_NO_CLOSE_UPPERBASE_BOOT,new zr],[h.OV_LEVITATE,new Gr],[h.OV_LEVITATE_NOCLOSE,new Ue],[h.CUSTOM_OV,new Ge],[h.IN_PAGE,new Ke(Ii,{})],[h.VH_BANNER,new Ke(Ii,{viewHackBannerMode:!0})],[h.EXPAND_BANNER,new Ur],[h.MULTIPLEX,new Qr],[h.INFEED,new qr],[h.NATIVE,new Nt]]);var Qe=class{constructor(){this.name="formatApplier",this._formats=_i(),this.resizeObserver=window.ResizeObserver?new ResizeObserver(e=>{e.forEach(t=>{var r,n;if(t.target instanceof HTMLDivElement&&t.target.id){let i=t.target.querySelector("iframe");T.postMessage({type:R.RESIZED,divId:t.target.id,width:(r=i==null?void 0:i.clientWidth)!=null?r:t.target.clientWidth,height:(n=i==null?void 0:i.clientHeight)!=null?n:t.target.clientHeight})}})}):null}get formats(){return this._formats}register(e){let t=this._formats.size+1;return this._formats.set(t,e),t}apply(e,t){return this.execInner(e,t,"applyInner")}onload(e,t){this.execInner(e,t,"onloadInner")}execInner(e,t,r){var a,d;let n=e.id,i=this._formats.get(n),s=document.getElementById(t);try{if(!i)throw new Error("formatId is invalid");if(s!==null&&!(s instanceof HTMLDivElement))throw new Error("element is not div");return s&&(r==="applyInner"?this.applyInner(i,s,(d=e.params)!=null?d:(a=Dt(n))==null?void 0:a.params):r==="onloadInner"&&this.onloadInner(i,s)),l.log(this.name,r,"executed for formatId:",n,"divId:",t),!!s||n===h.INTERSTITIAL}catch(c){return l.errorLog(this.name,"error occured while applying format",n,t),l.errorLog(c),!1}}applyInner(e,t,r){var i,s,a,d,c,f,S;(i=this.resizeObserver)==null||i.unobserve(t),(s=e.setParams)==null||s.call(e,t.id,r);let n=document.createDocumentFragment();e.create(n),(d=(a=e.hooks)==null?void 0:a.before)==null||d.call(a,n,t),(c=e==null?void 0:e.migrate)==null||c.call(e,n,t),(S=(f=e.hooks)==null?void 0:f.after)==null||S.call(f,document,t)}onloadInner(e,t){var n,i,s,a,d;(i=(n=e.hooks)==null?void 0:n.onload)==null||i.call(n,t);let r=t.querySelector("iframe");T.postMessage({type:R.FORMATTED,divId:t.id,width:(s=r==null?void 0:r.clientWidth)!=null?s:t.clientWidth,height:(a=r==null?void 0:r.clientHeight)!=null?a:t.clientHeight}),(d=this.resizeObserver)==null||d.observe(t)}};var Xr=class{constructor(e){this.requesterMap=e;this.formatApplier=new Qe}render(e){return g(this,null,function*(){yield this.applyFormatWithRetries(e),e.renderParams.formatSpec.id===h.MULTIPLEX?e.renderParams.formatSpec.params.infeedSlots.forEach(t=>this.render(t)):yield this.execRequest(e)})}execRequest(e){return g(this,null,function*(){try{if(!e.tag)throw"there is no tag.";l.log("render requested",e);let t=this.requesterMap[e.tag.adServer];if(!t)throw"there is no requester.";return this.reserveOnload(e),t.request([e])}catch(t){l.errorLog(t)}})}applyFormatWithRetries(e){return g(this,null,function*(){let t=e.renderParams.formatSpec;!this.formatApplier.apply(t,e.divId)&&document.readyState==="loading"&&(yield At(),this.formatApplier.apply(t,e.divId)||l.errorLog("failed to execute apply format after DOMContentLoaded."))})}reserveOnload(e){T.addMessageListenerOnce(R.RENDERED,t=>{if(t.data.divId!==e.divId)return!1;try{let r=e.renderParams.formatSpec;return this.formatApplier.onload(r,e.divId),!0}catch(r){return l.errorLog(r),!1}})}};var Jr=class{constructor(e){this.requesterMap=e;this.formatApplier=new Qe}render(e,t){return g(this,null,function*(){e.forEach(n=>{if(n.renderParams.isPassback&&!n.renderParams.isApplied)return;let i=n.renderParams.formatSpec;try{this.formatApplier.apply(i,n.divId),this.reserveOnload(n)}catch(s){l.errorLog(s)}}),this.requesterMap[t].request(e)})}reserveOnload(e){T.addMessageListenerOnce(R.RENDERED,t=>{if(t.data.divId!==e.divId)return!1;try{let r=e.renderParams.formatSpec;return this.formatApplier.onload(r,e.divId),!0}catch(r){return l.errorLog(r),!1}})}};var Pi=o=>g(void 0,null,function*(){return new Promise(e=>setTimeout(()=>e(),o))}),Ci=o=>g(void 0,null,function*(){return new Promise(e=>{let t=()=>{o(),e()};if(document.readyState==="loading"){document.addEventListener("DOMContentLoaded",t);return}t()})});var Ya=(o,e)=>{let t=e.toString().padStart(7,"0"),r=kt(o),n=t.slice(-6,-3),i=t.slice(-3);return`https://${r}/t/${n}/${i}/a${t}.js`},ja=()=>{let o="window.gnsfmtmod = window.gnsfmtmod || {};",e=document.createElement("script");return e.type="text/javascript",e.innerHTML=o,e},Ka=(o,e)=>`<!DOCTYPE html><html lang="ja"><head><meta charset="UTF-8"><style>body{margin:0;height:100%;background-color:transparent;width:100%;text-align:center;}</style>${ja().outerHTML}</head><body><script type="text/javascript" src="${Ya(o,e)}"><\/script>${Qa()}</body></html>`,Oi="_CptAldRenderEnded",Qa=()=>`<script>window.parent.postMessage({ type:"${Oi}"}, "*");<\/script>`,Xe=(o,e)=>g(void 0,null,function*(){return new Promise(t=>{var i;let r=s=>{if(s.origin!==window.origin)return;let a=s.source;!a||!("document"in a)||a.document===o&&s.data.type===Oi&&(window.removeEventListener("message",r),l.log("aladdin sync tag rendered"),t())};window.addEventListener("message",r);let n=(i=window.gn_aladdin_vendor_id)!=null?i:G.GJ;o.open(),o.write(Ka(n,e)),o.close(),l.log("writeRawAladdinTag")})});var Xa=o=>`<script src="https://cdn.jsdelivr.net/npm/prebid-universal-creative@latest/dist/native.js"><\/script>
<script>
    const ucTagData = {};
    ucTagData.pubUrl = window.location.href;
    ucTagData.adId = "${o}";
    ucTagData.requestAllAssets = true;
    window.ucTag?.renderAd(document, ucTagData);
<\/script>
`,Ja=`<script>
    ((window, document) => {
        const iframe = window.frameElement;
        if (!iframe) return;
        let scrollHeight = 0;
        iframe.style.width = "100%";
        const frameAdjuster = () => {
            iframe.style.height = scrollHeight + "px";
            const timer = setInterval(() => {
                if (document.body.scrollHeight > scrollHeight) {
                    scrollHeight = document.body.scrollHeight;
                    frameAdjuster();
                }

                if (scrollHeight > 0 && document.body.scrollHeight === scrollHeight) clearInterval(timer);
            }, 1000);
        };
        frameAdjuster();
    })(window, document);
<\/script>
`,Mi=(o,e)=>{o.open(),o.write(`<!DOCTYPE html><html lang="ja"><head><meta charset="UTF-8"></head><body>${Xa(e)}${Ja}</body></html>
`),o.close()};var xi=(o,e)=>new Promise(t=>{if(!window.gnpb)throw new Error("Prebid is not loaded");let r=a=>{var d;a.doc===e&&(l.log(`prebid without gam for ${o.divId} render ended`),(d=window.gnpb)==null||d.offEvent("adRenderSucceeded",r),t())};window.gnpb.onEvent("adRenderSucceeded",r);let n=window.gnpb.getHighestCpmBids(o.adUnitPath);if(!n.length)throw new Error("no bid");let i=n[0].adId;(o.settings.formatSpec.id===h.NATIVE?Mi:window.gnpb.renderAd)(e,i)});var Zr=class{constructor(e){this.events=e;this.events.on(p.GamRequester.NoAd,t=>{let r=t.adSlots[0];if(r.isInterstitial)return;let n=r.tag;(n==null?void 0:n.adServer)==="gam"&&n.fillNoAd&&(r.updateRenderParams({adServer:_e}),this.requestOne(r),Pn(r.divId),r.updateRenderParams({adServer:de}))})}notifyAdRendered(e){l.log(`Creative for ${e.divId} is rendered in iframe.`),T.postMessage({type:R.RENDERED,divId:e.divId,adUnitPath:e.adUnitPath,adServer:"aladdin"})}requestOne(e){var c;if(e.isInterstitial){this.events.emit(p.Requester.requestInterstitial),this.notifyAdRendered(e);return}let t=document.getElementById(e.divId),r=e.tag;if(!t||(r==null?void 0:r.adServer)!==_e)return;let{id:n,size:i}=r;if(!n||!i)return;t.innerHTML="";let s=y("iframe",{id:`gnpbad_${n}`,frameBorder:"0",scrolling:"no",referrerPolicy:"origin",width:i[0].toString(),height:i[1].toString()});s.style.verticalAlign="bottom",s.dataset.aladdinFormat="true",t.appendChild(s);let a=()=>g(this,null,function*(){let f=s.contentDocument;if(e.useAladdinAdapter)try{yield xi(e,f)}catch(S){l.errorLog(`Failed render prebid creative for ${e.divId} without GAM:`,S),yield Xe(f,n)}else yield Xe(f,n);f.body.style.margin="0",this.notifyAdRendered(e)});((c=window.__gn_config)==null?void 0:c.mediaId)===201547?Ci(a):a()}request(e){return g(this,null,function*(){for(let t of e)this.requestOne(t)})}},kt=o=>{var e;return(e=Jt[o])!=null?e:Jt[G.GJ]};var Li=class{constructor(){this.name="AladdinDetector",this.onloadCallbacks=[]}useMod(){return{type:p.onRegister,callback:(e,t)=>{t.emit(p.Refresher.prevent),t.once(p.init,(r,n)=>{this.run(r,n)},this)}}}registerCallbacks(e){let{config:t,adSlots:r}=e,n=r.filter(a=>{var d;return a.isRefreshable&&((d=a.settings.refresh)==null?void 0:d.excludeAladdin)}).map(a=>a.divId),i=r.filter(a=>a.settings.formatSpec.id===h.IN_PAGE&&a.settings.formatSpec.params.excludeAladdin||a.settings.formatSpec.id===h.VH_BANNER).map(a=>a.divId),s=r.filter(a=>hi(a.settings)).map(a=>a.divId);n.length>0&&this.onloadCallbacks.push(a=>{n.includes(a)&&this.postDenyRefreshMessage(a)}),i.length>0&&this.onloadCallbacks.push(a=>{i.includes(a)&&this.postCancelInpageMessage(a)}),s.length>0&&(t.enableOVKindness?this.onloadCallbacks.push(a=>{s.includes(a)&&this.postShowOverlayClose(a)}):T.addMessageListener(R.RENDERED,a=>{s.includes(a.data.divId)&&this.postShowOverlayClose(a.data.divId)}))}run(e,t){let{adSlots:r}=e;if(this.registerCallbacks(e),T.addMessageListener(R.RENDERED,i=>{let{divId:s,adServer:a}=i.data;!a||!s||(a==="aladdin"||a==="gam"&&this.isAladdinCreative(s))&&(this.onloadCallbacks.forEach(d=>d(s)),t.emit(p.Aladdin.renderEnded,d=>d.divId===s))}),!window.gnInpageCancelLineitems){t.emit(p.Refresher.permit);return}let n=r.filter(i=>i.settings.formatSpec.id===h.IN_PAGE).map(i=>i.divId);E.addEventListener("slotRenderEnded",i=>{var a;let s=i.slot.getSlotElementId();n.includes(s)&&i.sourceAgnosticLineItemId&&!!((a=window.gnInpageCancelLineitems)==null?void 0:a.includes(i.sourceAgnosticLineItemId))&&window.postMessage({type:me.CANCEL,slotDiv:s},"*")}),t.emit(p.Refresher.permit)}isAladdinCreative(e){var d,c;let t=document.getElementById(e);if(!t)return!1;let r=t.querySelector("iframe");if(!r)return!1;let n=(d=window.gn_aladdin_vendor_id)!=null?d:G.GJ,s=`//${kt(n)}/t/`;return!!((c=r.contentDocument)==null?void 0:c.body.querySelector(`script[src*='${s}']`))}postDenyRefreshMessage(e){window.postMessage({type:he,slotDiv:e},"*")}postCancelInpageMessage(e){window.postMessage({type:me.CANCEL,slotDiv:e},"*")}postShowOverlayClose(e){T.postMessage({type:Ct.SHOW_CLOSE,divId:e})}},Di=Li;var Za="CptAsyncYDNAdOnRequest",eo=class{constructor(){this.name="AsyncYDNHandler",this.isExecuted=!1,this.yadsRefreshCounts=new Map,this.yadReadyIds=new Set,this.yadAdDsList=new Map}useMod(){return{type:p.onRegister,callback:(e,t)=>{this.run(t)}}}run(e){if(this.isExecuted)return l.errorLog(this.name,"already executed");this.isExecuted=!0,window.YJ_YADS=window.YJ_YADS||{tasks:[]},window.addEventListener("message",t=>{var i,s,a;if(((i=t.data)==null?void 0:i.type)!==Za)return;let r=(s=t.data)==null?void 0:s.yads_ad_ds,n=(a=t.data)==null?void 0:a.divId;!r||!n||(this.yadAdDsList.set(n,r),this.tryRequestingYdnAd(n))}),window.addEventListener("message",t=>{var n;if(((n=t.data)==null?void 0:n.type)!==R.RENDERED)return;let r=t.data.divId;!r||this.tryRequestingYdnAd(r)}),e.on(p.Analyzer.intervalHit,t=>{for(let r of t.adSlots)this.yadAdDsList.delete(r.divId),this.yadReadyIds.delete(r.divId)})}tryRequestingYdnAd(e){if(!this.yadReadyIds.has(e)){this.yadReadyIds.add(e);return}let t=this.yadAdDsList.get(e);!t||(this.requestYdnAd(t,e),this.yadReadyIds.delete(e))}requestYdnAd(e,t){var i;window.YJ_YADS=(i=window.YJ_YADS)!=null?i:{tasks:[]},this.cloneStyleTagsInAdSourceWithScope(t);let r=this.yadsRefreshCounts.get(e),n=r?r+1:1;this.yadsRefreshCounts.set(e,n),window.YJ_YADS.tasks.push({yads_ad_ds:e,yads_parent_element:t,yads_request_seq:n})}cloneStyleTagsInAdSourceWithScope(e){let t=`gn_style_${e}`,r=document.getElementById(t);r==null||r.remove();let i=this.getStyleTagsFromAdSource(e).flatMap(s=>{var a;return Bn((a=s.textContent)!=null?a:"").map(d=>`${Hn(e)} ${d}`)});M(i,t)}getStyleTagsFromAdSource(e){let t=document.getElementById(e);if(!t)return[];let r=t.querySelector('iframe[id^="google_ads_iframe_"], iframe[id^="gnpbad_"]');if(!r)return[];let n=r.contentDocument;return n?Array.from(n.body.getElementsByTagName("style")):[]}};var to="CptInstBodyEnded",Fi=class{constructor(){this.name="lazyInterstitialHandler",this.isExecuted=!1}storeToStorage(e){let t=this.getPrebidAd(e.adUnitPath),r={adUnitId:e.settings.id,ad:t==null?void 0:t.ad,bidder:t==null?void 0:t.bidder,size:t?{width:t.width,height:t.height}:void 0,timeoutStr:X(60).toISOString()};l.log(this.name,"store Interstitial adinfo",r),window.localStorage.setItem(Ko,JSON.stringify(r))}useMod(){return{type:p.onRegister,callback:(e,t)=>{t.once(p.Requester.requestInterstitial,(r,n)=>{this.run(r)},this)}}}getPrebidAd(e){if(!window.gnpb){l.log(this.name,"Prebid is not loaded");return}let[t]=window.gnpb.getHighestCpmBids(e);if(!(t==null?void 0:t.ad)){l.log(this.name,"no bid");return}return t}run(e){if(this.isExecuted){l.errorLog(this.name,"already executed");return}this.isExecuted=!0;let t=e.adSlots.find(r=>r.isInterstitial);if(!t){l.log(this.name,"no intersititial adSlot Found");return}try{this.storeToStorage(t)}catch(r){l.errorLog(this.name,`error occurred while handing ${to}`,r)}}},Ni=Fi;var re={TOTAL_SHOWN_COUNT:"gnsinstcnt",ADX_SHOWN_IN_AN_HOUR:"gnsinstadxa",ADX_TRY_COUNT:"adxtrycnt",USER_CLASSIFICATION:"__gnusrcls"},ro={SHOWN:"1"},oo="__adx_inst_shown__";var no=class{constructor(e,t){this.state=e;this.availableMinutes=t;sessionStorage.removeItem(oo)}onPermitted(e){e==="gam"&&Se(re.ADX_TRY_COUNT,(this.state.adxTryCount+1).toString(),X(this.availableMinutes))}onRendered(e){if(e!=="gam")return;let t=X(60);Se(re.ADX_SHOWN_IN_AN_HOUR,ro.SHOWN,t),Se(re.ADX_TRY_COUNT,"0",X(-1)),sessionStorage.setItem(oo,ro.SHOWN)}};var io=class{constructor(e,t){this.state=e;this.availableMinutes=t}onRendered(e){this.state.totalShownCount++,Se(re.TOTAL_SHOWN_COUNT,this.state.totalShownCount.toString(),X(this.availableMinutes))}};var so=class{constructor(){this.updaters=[]}addUpdater(e){this.updaters.push(e)}onPermitted(e){this.updaters.forEach(t=>{var r;return(r=t.onPermitted)==null?void 0:r.call(t,e)})}onRendered(e){this.updaters.forEach(t=>t.onRendered(e))}};var Bi=(o,e)=>{let t=new so;return t.addUpdater(new io({totalShownCount:o.totalShownCount},e.frequencyAvailableMinutes)),t.addUpdater(new no({adxTryCount:o.adxTryCount},e.frequencyAvailableMinutes)),t};var el="2",tl="#google_vignette",rl=()=>{var e;let o=(e=gt(re.USER_CLASSIFICATION))==null?void 0:e.split(".");return(o==null?void 0:o.slice(-1)[0])===el},ao=class{constructor(){this.name="interstitialController",this.isExecuted=!1}useMod(){return{type:p.onRegister,callback:(e,t)=>{t.emit(p.Refresher.prevent),t.once(p.init,(r,n)=>{this.run(r,n)},this)}}}run(e,t){if(this.isExecuted)return l.errorLog(this.name,"already executed");this.isExecuted=!0;let r=e.adSlots.find(i=>i.isInterstitial);if(l.log("check adslots:",r),!r)return l.log(this.name,"no intersititial adSlot found"),t.emit(p.Refresher.permit);if(window.gnshbrequest.preventDefaultRefresh(K),!("limitation"in r.settings))return l.errorLog(this.name,"interstitial limitation parameter is missing."),t.emit(p.Refresher.permit);let n=r.settings.limitation;Le("message",i=>{var d,c,f,S;if(i.data.type!==to)return!1;if(window.gn_use_classification&&rl())return l.log(this.name,"current user is loyal."),!0;if(n.frequencyCount===0)return!0;let s=i.data,a=Bi({adxTryCount:(c=(d=s.lastState)==null?void 0:d.adxTryCount)!=null?c:0,totalShownCount:(S=(f=s.lastState)==null?void 0:f.totalShownCount)!=null?S:0},n);return this.setSlotReady(r,n,s,a),this.listenToGamRendered(a),window.gnshbrequest.permitDefaultRefresh(K),!0}),this.listenToGamResponsed(r),this.initCmdQ(),t.emit(p.Refresher.permit)}listenToGamRendered(e){Le("hashchange",()=>window.location.hash!==tl?!1:(e.onRendered("gam"),!0))}setSlotReady(e,t,r,n){var i,s,a;r.status==="success"&&n.onRendered("aladdin"),this.permitsGamRequest(r,t)?((i=n.onPermitted)==null||i.call(n,"gam"),e.updateRenderParams({targeting:{[Xo]:(((a=(s=r.lastState)==null?void 0:s.adxTryCount)!=null?a:0)+1).toString()}})):e.updateRenderParams({adServer:"aladdin"})}listenToGamResponsed(e){E.addEventListener("slotRenderEnded",t=>{t.slot.getAdUnitPath()===e.adUnitPath&&(t.isEmpty?l.errorLog(this.name,"No GAM Response for Interstitial",e.adUnitPath):l.log("GAM Interstitial ad received",e.adUnitPath))})}permitsGamRequest(e,t){var r,n,i,s,a;if(e.status==="ban_page")return!1;if(e.adUnitId===void 0){let d=(n=(r=e.lastState)==null?void 0:r.adxTryCount)!=null?n:0,c=(s=(i=e.lastState)==null?void 0:i.totalShownCount)!=null?s:0;return t.adxTryCount>d&&t.frequencyCount>c}return(a=e.isGamPermitted)!=null?a:!1}initCmdQ(){var r;let e=(r=window.gnsinst_notify)==null?void 0:r.cmd,t=n=>{if(typeof n=="function")try{l.log(this.name,"gnsinst_notify.cmd invoked"),n()}catch(i){l.errorLog(this.name,"error occured in gnsinst_notify.cmd",i)}};if(Array.isArray(e))for(;e.length;)t(e.shift());window.gnsinst_notify={cmd:{push:t,unshift:t}}}};var Hi=class{constructor(){this.name="PageKeyValueSetter"}useMod(){return{type:p.onRegister,callback:(e,t)=>{this.run(e),t.on(p.reload,(r,n)=>{n.emit(p.Refresher.prevent),this.run(r),n.emit(p.Refresher.permit)},this)}}}run(e){var i;let{adSlots:t,config:r}=e;if(!t.length){l.log(this.name,"target adslot not found");return}if(l.log(this.name,`sets PVID to ${Ee}`),E.setTargeting(Qo,Ee),r.usePPID){let s="gn_ppid",a=window.localStorage.getItem(s);a||(a=Ee,window.localStorage.setItem(s,a)),l.log(this.name,`set ppid to ${a}`),E.setPublisherProvidedId(a)}let n=(i=e.runEnv.deliveryType)!=null?i:dn()?lr.IN_IFRAME:lr.DEFAULT;l.log(this.name,`set {${ar}:${n}} in custom param`),E.setTargeting(ar,n)}},Ui=Hi;var ki=class{constructor(){this.name="UPRApplier"}useMod(){return{type:p.onRegister,callback:({adSlots:e})=>{e.forEach(t=>{let r=t.tag;if((r==null?void 0:r.adServer)!=="gam"||(r.minPriceRule&&t.updateRenderParams({targeting:{[we.minPrice]:r.minPriceRule.aladdinCpm.toString()}}),!r.upr))return;let n=Rr(r.upr);!n||ol(t,n)})}}}},ol=(o,e)=>{l.log(`[UPRApplier]Set UPR to divId ${o.divId}`,e),o.updateRenderParams({targeting:e})},Gi=ki;var Je={PATH:"https://cpt.geniee.jp/hb/v1/adnetwork-check",TARGETING:{KEY:"geniee-check",OK:"0",NG:"1"}},Vi=class{constructor(){this.name="AdnetworkChecker"}useMod(){return{type:p.onRegister,callback:(e,t)=>{t.emit(p.Refresher.prevent),t.once(p.init,(r,n)=>{this.run(r,n)},this)}}}run(e,t){return g(this,null,function*(){let{config:r}=e;if(!r.isLD){l.log(this.name,"not livedoorBlog"),t.emit(p.Refresher.permit);return}E.setTargeting(Je.TARGETING.KEY,Je.TARGETING.NG);let n=yield this.inquire(r.timeout);n&&E.setTargeting(Je.TARGETING.KEY,Je.TARGETING.OK),l.log(this.name,"is ydn ok:",n),t.emit(p.Refresher.permit)})}inquire(){return g(this,arguments,function*(e=B){let t=ft();if(!t)return l.errorLog("AdnetworkChecker location not found"),!1;let r=Je.PATH+"?loc="+window.encodeURIComponent(t);try{let n=yield ht(r,e);return this.checkResult(n)}catch(n){return!1}})}checkResult(e){try{let t=JSON.parse(e);return t.msg&&l.errorLog(this.name,t.msg),t.block===0}catch(t){return l.errorLog(this.name,"API Response was broken",t),!1}}},zi=Vi;var ue=class{constructor(e){this.teardown=null,this.subscriber=e}subscribe(e){if(!this.subscriber)throw new Error("there is no subscriber");return this.teardown=this.subscriber(e),this}unsubscribe(){!this.teardown||(this.teardown(),this.subscriber=null,this.teardown=null)}},k=(o,e)=>new ue(t=>(o.addEventListener(e,t),()=>{var r;return(r=o.removeEventListener)==null?void 0:r.call(o,e,t)})),Ze=o=>new ue(e=>{let t=window.setTimeout(e,o);return()=>window.clearTimeout(t)}),qi=o=>new ue(e=>{let t=!1;return o.then(r=>{t||e.call(null,r)}).catch(()=>{}),()=>{t=!0}}),$i=(...o)=>new ue(e=>{let t=Array.from(new Array(o.length)).map(()=>!1),r=o.map((n,i)=>n.subscribe(()=>{t[i]=!0,t.every(s=>!!s)&&e()}));return()=>r.forEach(n=>n.unsubscribe())});var Wi=class{constructor(e,t){this.ceil=t;this.measureLabel=`${e}-${ur()}`,this.runningMarkName=null,this.ceilTimeoutId=null}getLabel(){return this.measureLabel}getTotal(){return this.runningMarkName&&(this.stop(),this.start()),Math.floor(window.performance.getEntriesByName(this.measureLabel,"measure").reduce((e,t)=>e+t.duration,0))}start(){var e,t;this.runningMarkName||(this.addMark(),!!((e=this.ceil)==null?void 0:e.ceil)&&((t=this.ceil)==null?void 0:t.ceil)>0&&this.setCeilTimeout())}stop(){!this.runningMarkName||(this.addMeasure(),!(!this.ceil||!this.ceilTimeoutId)&&this.clearCeilTimeout())}reset(){return window.performance.clearMeasures(this.measureLabel),null}addMark(){let e=`${this.measureLabel}-${ur()}`;window.performance.mark(e),this.runningMarkName=e}addMeasure(){!this.runningMarkName||(window.performance.measure(this.measureLabel,this.runningMarkName),this.runningMarkName=null)}execCeilCallback(){var e,t;this.stop(),!!this.ceil&&((t=(e=this.ceil).callback)==null||t.call(e),this.start())}setCeilTimeout(){!this.ceil||(this.ceilTimeoutId=window.setTimeout(()=>this.execCeilCallback(),this.ceil.ceil))}clearCeilTimeout(){var e;!this.ceilTimeoutId||(window.clearTimeout(this.ceilTimeoutId),this.ceilTimeoutId=null,((e=this.ceil)==null?void 0:e.ceil)&&(this.ceil.ceil-=this.getTotal()))}},lo=Wi;var Gt=class{constructor(e,t,r,n){this.adSlot=e;this.events=t;this.prebidMinInterval=r;var i;this.divId=e.divId,this.isStarted=!1,this.slotObservables=[],this.timer=null,this.onMouse=!1,this.preset={path:e.oldAdUnitPath,viewableInterval:((i=e.settings.refresh)==null?void 0:i.viewableInterval)||Oo,nthRefresh:n||1},this.calculation={inviewTime:0,viewToClickTime:0}}start(e){var t;if(this.slotObservables=[k(e,"mouseenter").subscribe(()=>this.setSlotOnMouse(!0)),k(e,"mouseleave").subscribe(()=>this.setSlotOnMouse(!1))],(t=this.adSlot.settings.refresh)==null?void 0:t.use){let r=this.createObservableTimer(this.adSlot.settings.refresh.viewableInterval);r&&this.slotObservables.push(r)}else this.timer=new lo(this.divId);return this.isStarted=!0,this}getResult(){return this.isStarted&&this.timer&&(this.calculation.inviewTime=this.timer.getTotal()),this.makeResult()}getNthRefresh(){var e;return(e=this.preset)==null?void 0:e.nthRefresh}end(){if(!!this.isStarted){for(;this.slotObservables.length;)this.slotObservables.pop().unsubscribe();if(!!this.timer)return this.timer=this.timer.reset(),this.isStarted=!1,null}}setSlotViewability(e){!this.isStarted||!this.timer||(e>=zo?this.timer.start():this.timer.stop())}setSlotOnMouse(e){!this.isStarted||(this.onMouse=e)}notifySlotClicked(){!this.isStarted||this.calculation.viewToClickTime||!this.timer||(this.calculation.viewToClickTime=this.timer.getTotal())}notifyWindowBlur(){!this.isStarted||!this.onMouse||this.notifySlotClicked()}makeResult(){return Object.assign(this.preset,this.calculation)}createObservableTimer(e){if(this.adSlot.settings.refresh)return $i(Ze(this.adSlot.settings.refresh.gamPolicyInterval),Ze(this.prebidMinInterval),qi(new Promise(t=>{this.timer=new lo(this.divId,{ceil:e,callback:t})}))).subscribe(()=>{this.events.emit(p.Analyzer.intervalHit,t=>t.divId===this.divId)})}};var Vt=class{constructor(e,t){this.events=t;var r;this.name="AnalyzeGlobalCalc",this.adSlots=e.adSlots,this.globalObservables=[],this.slotCalcs={},this.preset={t:Et.VIEWABLE_INTERVAL,url:window.location.href,date:new Date().toISOString().substring(0,10)},this.calculation={staytime:0,adUnit:[]},this.transmissionRate=(r=e.config.logTransmissionRate)!=null?r:10,this.viewableObserver=null}start(){return IntersectionObserver?(this.globalObservables=[this.toStartMeasurementOnSlotCreated(),this.toToggleTimerOnSlotViewabilityChanged(),this.toToggleTimerOnWindowVisibilityChanged(),this.toNotifyClickOnWindowBlur()],this):this}getResult(e){return Object.keys(this.slotCalcs).filter(r=>e.includes(r)).map(r=>this.slotCalcs[r].getResult()).forEach(r=>{this.calculation.adUnit=this._pushFilteredResult(this.calculation.adUnit,r)}),this.calculation.adUnit.length?(this.calculation.staytime=Math.floor(window.performance.now()),Object.assign(this.preset,this.calculation)):null}_pushFilteredResult(e,t){let r=[...e];return(t.viewToClickTime!==0||Math.floor(Math.random()*100)<this.transmissionRate)&&r.push(t),r}end(){return this.globalObservables.forEach(e=>e.unsubscribe()),Object.keys(this.slotCalcs).forEach(e=>this.slotCalcs[e].end()),this.globalObservables=[],this.slotCalcs={},null}toStartMeasurementOnSlotCreated(){return k(window,"message").subscribe(e=>{var d,c;if(!this.viewableObserver||((d=e.data)==null?void 0:d.type)!==R.RENDERED)return;let t=this.adSlots.find(f=>f.divId===e.data.divId);if(!t)return;let r=t.getRenderedPrebidBidder(),n=t.getPrebidRefreshPolicyFor(r!=null?r:"");r?l.log(`${this.name}: "${r}" won the auction for "${t.divId}":`,n):l.log(`${this.name}: Prebid creative for "${t.divId}" is not rendered currently`);let i=document.getElementById(t.divId),s=this.slotCalcs[t.divId],a=s?this.tearDownSlotCalc(s,t.settings.__unstable_logCommit,i):0;!i||(this.slotCalcs[t.divId]=new Gt(t,this.events,(c=n==null?void 0:n.minInterval)!=null?c:0,a+1).start(i),this.viewableObserver.observe(i))})}tearDownSlotCalc(e,t,r){var i;t&&(this.calculation.adUnit=this._pushFilteredResult(this.calculation.adUnit,e.getResult()));let n=e.getNthRefresh();return e.end(),r&&((i=this.viewableObserver)==null||i.unobserve(r)),n}toToggleTimerOnSlotViewabilityChanged(){return new ue(e=>(this.viewableObserver=new IntersectionObserver(e,{root:null,rootMargin:"0px 100px 0px",threshold:[.5]}),()=>{var t;(t=this.viewableObserver)==null||t.disconnect(),this.viewableObserver=null})).subscribe(e=>{for(let t of e){let{target:r,intersectionRatio:n}=t;if(!(r instanceof HTMLElement)||!r.id)continue;let i=this.slotCalcs[r.id];i&&i.setSlotViewability(n*100)}})}toToggleTimerOnWindowVisibilityChanged(){return k(window,"visibilitychange").subscribe(()=>{document.visibilityState==="hidden"?Object.keys(this.slotCalcs).forEach(e=>{this.slotCalcs[e].setSlotViewability(0)}):Object.keys(this.slotCalcs).forEach(e=>{let t=document.getElementById(e);if(!t)return;let r=Dn(t);this.slotCalcs[e].setSlotViewability(r*100)})})}toNotifyClickOnWindowBlur(){return k(window,"blur").subscribe(()=>{var r,n,i;let e=document.activeElement instanceof HTMLIFrameElement?document.activeElement:null,t=(e==null?void 0:e.dataset.aladdinFormat)?(r=e.parentElement)==null?void 0:r.id:(i=(n=e==null?void 0:e.parentElement)==null?void 0:n.parentElement)==null?void 0:i.id;Object.keys(this.slotCalcs).forEach(s=>{s===t?this.slotCalcs[s].notifySlotClicked():this.slotCalcs[s].notifyWindowBlur()})})}};var W={INIT:0,STARTED:1,GOTRESULT:2,ENDED:3,LOGSENT:4,EXIT:9},Yi=class{constructor(){this.name="Analyzer",this.status=W.INIT,this.calc=null,this.data=null}startAnalyze(e,t){let{adSlots:r,config:n,runEnv:i}=e;if(this.status!==W.INIT)return;this.status=W.STARTED;let s=r.filter(c=>{var f;return((f=c.settings.refresh)==null?void 0:f.use)||c.settings.__unstable_logCommit});if(!s.length){l.log(this.name,"no target ad units"),this.status=W.EXIT,t.emit(p.Refresher.permit);return}l.log(this.name,"analyze targets:",s.map(c=>c.divId)),this.calc=new Vt({adSlots:s,config:n,runEnv:i},t),window.googletag.cmd.push(()=>{var c;(c=this.calc)==null||c.start()});let a=r.filter(c=>c.settings.__unstable_logCommit).map(c=>c.divId);l.log(this.name,"log commit targets:",a);try{if(!a.length)throw"theres no log-commiting target"}catch(c){l.errorLog(this.name,"committer doesn't work on this environment",c);let f=k(window,"beforeunload").subscribe(()=>{this.endAnalyze(),f.unsubscribe()});t.emit(p.Refresher.permit);return}let d=[k(window,"beforeunload").subscribe(()=>{d.forEach(c=>c.unsubscribe()),this.getResult(a),this.endAnalyze(),this.commitData()}),Ze(n.sessionTimeout).subscribe(()=>{d.forEach(c=>c.unsubscribe()),this.getResult(a),this.endAnalyze(),this.commitData()})];t.emit(p.Refresher.permit)}getResult(e){this.status!==W.STARTED||!this.calc||(this.data=this.calc.getResult(e))}endAnalyze(){var e;![W.STARTED,W.GOTRESULT].includes(this.status)||(this.status=W.ENDED,(e=this.calc)==null||e.end(),this.calc=null)}commitData(){this.status!==W.ENDED||!this.data||(l.log(this.name,"trying to send log:",this.data),Te(this.data))}useMod(){return{type:p.onRegister,callback:(e,t)=>{t.emit(p.Refresher.prevent),t.once(p.init,(r,n)=>{this.startAnalyze(r,n)},this)}}}},ji=Yi;var nl={pubID:nt,adServer:"googletag",bidTimeout:B},il=`<script>
  !function(a9,a,p,s,t,A,g){if(a[a9])return;function q(c,r){a[a9]._Q.push([c,r])}a[a9]={init:function(){q("i",arguments)},fetchBids:function(){q("f",arguments)},setDisplayBids:function(){},targetingKeys:function(){return[]},_Q:[]};A=p.createElement(s);A.async=!0;A.src=t;g=p.getElementsByTagName(s)[0];g.parentNode.insertBefore(A,g)}("apstag",window,document,"script","//c.amazon-adsystem.com/aax2/apstag.js");

  function requestBids(apsConfig, bidConfig) {
    apstag.init(apsConfig);
    apstag.fetchBids(
      bidConfig,
      function (bids) {
        window.parent.postMessage({type:'${tr}',bids: bids}, "*");
      }
    );
  }

  window.addEventListener("message", function(ev) {
    if (ev.data?.type !== '${er}') return;
    requestBids(ev.data?.apsConfig, ev.data?.bidConfig);
  });
<\/script>`,Ki=(o,e)=>{var n;if(!o.length)return Promise.resolve("no adunit");if(!e.uam||!e.uam.use)return Promise.resolve("apstag setting is not turned on");if(window.gn_uam_domain_whitelist&&!vt(window.gn_uam_domain_whitelist))return Promise.resolve("current domain is not exist in whitelist");let t=dl(e.uam),r={slots:ll(o),timeout:(n=e.timeout)!=null?n:B};return e.uam.externalApstag?al(o,t,r):sl(o,t,r)},sl=(o,e,t)=>{let r=window.apstag;return r?new Promise(n=>{r.init(e),r.fetchBids(t,i=>{Qi(o,i),n("apstag BidEnd")})}):Promise.reject("apstag is not loaded")},al=(o,e,t)=>{var s;let r=()=>{let a=y("iframe",{id:rr,width:"0px",height:"0px",frameBorder:"0px"});a.style.display="none",document.body.append(a);let d=a.contentDocument;return d.open(),d.write(il),d.close(),a},n=(s=document.getElementById(rr))!=null?s:r();if(!n.contentWindow)return Promise.reject("external apstag is broken");let i=n.contentWindow;return new Promise(a=>{Le("message",d=>d.data.type!==tr?!1:(Qi(o,d.data.bids),window.__gn_external_apstag=i.apstag,a("external apstag BidEnd"),!0)),i.postMessage({type:er,apsConfig:e,bidConfig:t},"*")})},ll=o=>o.map(e=>({slotID:e.divId,slotName:e.oldAdUnitPath,sizes:e.settings.slotSizes})),dl=({pubID:o})=>v(u({},nl),{pubID:o!=null?o:nt}),cl=(o,e)=>t=>t.slot.getSlotElementId()!==e.divId?!1:(Object.keys(o).forEach(r=>t.slot.clearTargeting(r)),!0),Qi=(o,e)=>{e.forEach(t=>{l.log("apstag bid",t),l.log("slotIds",o.map(i=>i.divId));let r=o.find(i=>i.divId===t.slotID);if(!r)return;let n={amznbid:t.amznbid,amzniid:t.amzniid,amznp:t.amznp,amznsz:t.amznsz};r.updateRenderParams({targeting:n}),E.addEventListenerOnce("slotRenderEnded",cl(n,r))})};var Xi="geniee",pl=5e3,ml=o=>({title:{required:!0,len:80},image:{required:!1,sizes:o},sponsoredBy:{required:!0}}),Ji={BANNER:0,FOOTER_OV:1,HEADER_OV:2},Zi=(o,e)=>{let t=o.flatMap(i=>i.renderParams.formatSpec.id===h.MULTIPLEX?i.renderParams.formatSpec.params.infeedSlots:i),r=window.gnpb;if(!t.length)return Promise.resolve("no adunit");if(!r)return Promise.reject("prebid is not loaded");let n=i=>{r.que.push(()=>{i(r)})};return new Promise((i,s)=>{var f;let a=!1,d=["appnexus"],c=(f=window.gn_prebid_load_timeout)!=null?f:pl;window.setTimeout(()=>{a||s("prebid load timeout")},c),n(S=>{var oe;a=!0,S.setConfig(hl(e)),Array.isArray(window.gn_skip_schain_bidders)&&window.gn_skip_schain_bidders.length>0&&S.setBidderConfig({bidders:window.gn_skip_schain_bidders,config:{schain:{validation:"strict",config:{ver:"1.0",complete:1,nodes:[]}}}}),S.bidderSettings.standard={adserverTargeting:vl(t),bidCpmAdjustment:yl((oe=e.prebid)==null?void 0:oe.bca)},Sl();let D=window.gn_ydn_domain_whitelist===void 0||vt(window.gn_ydn_domain_whitelist)?t.flatMap(es):t.flatMap(es).map(Ce=>ul(d,Ce));S.addAdUnits(D),S.requestBids({timeout:e.timeout,bidsBackHandler:()=>{t.forEach(Ce=>{var Ro;let tt=S.getAdserverTargetingForAdUnitCode(Ce.adUnitPath);Ce.updateRenderParams({targeting:tt}),gl(Ce,(Ro=tt==null?void 0:tt.hb_bidder)!=null?Ro:"")}),i("prebid bidEnd")}})})})},ul=(o,e)=>v(u({},e),{bids:e.bids.filter(t=>!o.includes(t.bidder))}),gl=(o,e)=>{if(e!==Xi||!o.renderParams.pureAd)return;let t=o.renderParams.pureAd.type;if(t===Ji.FOOTER_OV){let r={id:h.CUSTOM_OV,params:{useHeaderOV:!1,preventsBottomContentOverlap:!1,bgColor:"transparent"}};o.updateRenderParams({adServer:"aladdin",formatSpec:r});return}if(t===Ji.HEADER_OV){let r={id:h.CUSTOM_OV,params:{useHeaderOV:!0,preventsBottomContentOverlap:!1,bgColor:"transparent"}};o.updateRenderParams({adServer:"aladdin",formatSpec:r});return}o.updateRenderParams({adServer:"aladdin"})},co=(o,e)=>{var f,S,_;let t=(f=window.gn_native_params)==null?void 0:f[o.settings.id],r=o.settings.bids,n=(S=o.settings.mediaTypes.banner)==null?void 0:S.sizes,{bids:i,sizes:s}=e!=null?e:{bids:void 0,sizes:void 0},a={code:o.adUnitPath,mediaTypes:v(u({},o.settings.mediaTypes),{banner:{sizes:s?n==null?void 0:n.filter(s):n}}),bids:i?r.filter(i):r,sizes:s?o.settings.slotSizes.filter(s):o.settings.slotSizes};if(!t)return a;for(let D of r)D.bidder===Xi&&(D.params.native=t);let d=[300,250],c=(_=o.settings.slotSizes[0])!=null?_:d;return v(u({},a),{nativeParams:ml(c)})},es=o=>{var s,a;if(!o.isOverlay)return[co(o)];let e="appnexus",t=100,r=co(o,{bids:d=>d.bidder===e,sizes:([,d])=>d<=t}),n=co(o,{bids:d=>d.bidder!==e});return[...r.bids.length&&((a=(s=r.mediaTypes)==null?void 0:s.banner)==null?void 0:a.sizes).length?[r]:[],...n.bids.length?[n]:[]]},fl=o=>{let e=[{name:"criteo"},{name:"imuid",params:{cid:8015}},{name:"sharedId",storage:{type:"cookie",name:"_pubcid",expires:30}}],t="gn_id5",r=window.localStorage.getItem(t),n={name:"id5Id",params:{partner:1216},storage:{type:"html5",name:"id5id",expires:90,refreshInSeconds:8*3600}};return o.useID5?r==="1"?(e.push(n),e):(r||(sn()>20?(e.push(n),window.localStorage.setItem(t,"1")):window.localStorage.setItem(t,"0")),e):e},hl=o=>{let e={schain:{validation:"strict",config:{ver:"1.0",complete:1,nodes:[{asi:"genieesspv.jp",sid:o.prebid.schainSid,hp:1}]}},bidderTimeout:B,useBidCache:!0,enableSendAllBids:!1,userSync:{filterSettings:{iframe:{bidders:"*",filter:"include"}},userIds:fl(o.prebid)},gptPreAuction:{useDefaultPreAuction:!0}},t={buckets:[{max:400,increment:1},{max:5e3,increment:20}]},r={buckets:[{max:4,increment:.01},{max:20,increment:.2}]},n=o.bidCurrency==="USD";return v(u({},e),{priceGranularity:n?r:t,currency:{adServerCurrency:n?"USD":"JPY",defaultRates:{USD:{JPY:143}}}})},vl=o=>{let e=o.reduce((r,n)=>(r[n.adUnitPath]=n.settings.AC,r),{}),t={key:"type",val:function(r){let n=e[r.adUnitCode];return parseFloat(r.pbCg)>=n?"H":""}};return[...Go,t]},yl=o=>e=>e*El(o),El=o=>{if((o==null?void 0:o.length)!==6)return 1;let e=(parseInt(o.slice(0,3),16)-1e3)/1e3,t=(4e3-parseInt(o.slice(-3),16))/1e3;return Number.isNaN(e)||Number.isNaN(t)||e!==t?1:e},ts="__gnpb_analytics",Sl=()=>{var o;ts in window&&window[ts]===!0&&Math.floor(Math.random()*1e3)<1&&((o=window.gnpb)==null||o.enableAnalytics({provider:"geniee"}))};var zt=class{constructor(){this.name="Bidder"}requestBids(e,t){return g(this,null,function*(){let{adSlots:r,config:n,runEnv:i}=e,s=e.adSlots.filter(a=>a.canUseHB);if(!!s.length)return t.emit(p.Bidder.bidStart),Promise.allSettled([Zi(s.filter(a=>a.settings.usePrebid&&a.isReady),n),Ki(s.filter(a=>a.settings.useUam&&a.isReady&&!a.hasStoppedGamTraffic),n)]).then(a=>{t.emit(p.Bidder.bidEnd),l.log(this.name,"bid finished",a);let d=(i.useSingleRequest?r:s).map(c=>c.divId);t.emit(p.Bidder.requestRefresh,c=>d.includes(c.divId))})})}addReBidEvent(e){e.on(p.Refresher.requestReBid,(t,r)=>{this.requestBids({runEnv:t.runEnv,adSlots:t.adSlots,config:F(t.config,{timeout:Bo})},r)},this)}useMod(){return{type:p.onRegister,callback:(e,t)=>{t.on(p.init,(r,n)=>{this.requestBids(r,n)},this),t.once(p.init,(r,n)=>{this.addReBidEvent(n)},this)}}}};var po=o=>{var r,n,i;window.gecptparams=(r=window.gecptparams)!=null?r:{},window.gecptparams.cps=(n=window.gecptparams.cps)!=null?n:{};let e=(i=window.gecptparams.cps)!=null?i:{},t=F(e,o);window.gecptparams.cps=t},rs=()=>{po({plc:H.POLICY.OK})},os=()=>{po({plc:H.POLICY.NG})},Al=(o,e)=>{po({[o]:e})},ns=o=>{Al(o,{rfr:Oe})};var is=o=>new Set(o.map(t=>t.settings.gamId));var ss=class{constructor(){this.name="PolicyChecker",this.isExecuted=!1}useMod(){return{type:p.onRegister,callback:(e,t)=>{t.emit(p.Refresher.prevent),t.once(p.init,(r,n)=>{this.run(r,n)},this)}}}run(e,t){return g(this,null,function*(){let{config:r,adSlots:n}=e,i=[...is(n)];if(this.isExecuted){l.errorLog(this.name,"already executed");return}this.isExecuted=!0;let s=()=>{t.emit(p.Refresher.permit),this._initCmdQ()};if(!r.usePolicyChecker){l.log(this.name,"setting is turned off"),s();return}let a=E.setTargetingForPubadsPromise(H.POLICY.KEYS,H.POLICY.NG);if(os(),!r.mediaId){l.log(this.name,"mediaId is undefined"),this.onNG(n),s();return}return new wt().inquire(String(r.mediaId),i,r.isLD,r.timeout).then(d=>g(this,null,function*(){return yield a,l.log(this.name,"is policy ok:",d),d?this.onOK():this.onNG(n)})).catch(d=>(l.errorLog(this.name,d),this.onNG(n))).finally(s)})}onOK(){return rs(),E.setTargetingForPubadsPromise(H.POLICY.KEYS,H.POLICY.OK)}onNG(e){e.forEach(t=>{t.updateRenderParams({adServer:_e,isGamSlotExists:!1})}),window.gnshbrequest.abortAllSlots()}_initCmdQ(){var r;let e=(r=window.gnpc)==null?void 0:r.que;if(!e)return;let t=n=>{if(typeof n=="function")try{l.log("gnpc.que invoked"),n()}catch(i){l.errorLog("error occured in gnpc.que",i)}};if(Array.isArray(e))for(;e.length;)t(e.shift());window.gnpc&&(window.gnpc.que={push:t,unshift:t})}},as=ss;var ls=()=>[ao,Ni,Ui,as,zi,ji,zt,eo,Di,Gi];var ds=class{constructor(){this.eventBank={}}on(e,t,r=null){t.guid||(t.guid=Symbol()),t.thisArg=r;let n=this.eventBank[e];return Array.isArray(n)?n.push(t):this.eventBank[e]=[t],l.eventLog("event registered for:",e),(()=>{this.off(e,t.guid)}).bind(this)}once(e,t,r=null){let n=Symbol(),i=(...s)=>{t(...s),this.off(e,n)};return i.guid=n,this.on(e,i,r)}off(e,t){if(!t){delete this.eventBank[e],l.eventLog("event canceled for:",e);return}let r=this.eventBank[e];if(!r)return;let n=r.reduce((i,s,a)=>s.guid===t?a:i,-1);n!==-1&&(r.splice(n,1),r.length||delete this.eventBank[e],l.eventLog("event canceld:",e,"for specific callback"),l.eventLog(e,this.eventBank[e]))}emit(e,...t){var n;let r=this.eventBank[e];if(!(!r||!Array.isArray(r))){l.eventLog("event emit:",e);for(let i=r.length-1;i>=0;i--)try{let s=r[i];s.call((n=s.thisArg)!=null?n:null,...t)}catch(s){l.errorLog("event Error Occured in type",e,s)}}}getEventNames(){return Object.keys(this.eventBank)}},cs=ds;var ps=class extends cs{constructor(e){super();this.adSlotsService=e;this._config=Uo,this.runEnv=ko}set config(e){let t=v(u({},e),{uam:mt(e.uam,Zt,"use")});this._config=F(this._config,t),l.log("configuration changed",this._config)}get context(){return{adSlots:this.adSlotsService.getAll(),config:this._config,runEnv:this.runEnv}}updateRunEnv(e){this.runEnv=F(this.runEnv,e),l.log("running context changed",this.runEnv)}emit(e,t){super.emit(e,{adSlots:this.adSlotsService.getBy(t),config:dt(this._config),runEnv:dt(this.runEnv)},this)}},ms=class{constructor(e){this.adSlotsService=e;this.events=new ps(this.adSlotsService),this.modStore={}}_register(...e){e.flat().forEach(t=>{if(typeof t!="function")return;let r=new t;if(!r.name||!r.useMod||this.modStore[r.name])return;let{type:n,callback:i}=r.useMod(),s=this.events.once(n,i,r);this.modStore[r.name]={removeFn:s},l.log(`mod: ${r.name} registered`)})}setConfig(e){this.events.config=e}updateRunEnv(e){this.events.updateRunEnv(e)}enableMods(){return this._register(...ls()),this.events.emit(p.onRegister),this}emit(e){this.events.emit(e)}getModNames(){return Object.keys(this.modStore)}};var us=ms;var qt=(o,e)=>{let t=(f,S)=>f+(S!=null?S:0),r=t(o.getFullYear(),e.year),n=t(o.getMonth(),e.month),i=t(o.getDate(),e.day),s=t(o.getHours(),e.hour),a=t(o.getMinutes(),e.minute),d=t(o.getMinutes(),e.second),c=t(o.getMilliseconds(),e.ms);return new Date(r,n,i,s,a,d,c)};var bl="gn_ow_lra",$t=un(bl),Wt=$t.get,Rv=$t.set,gs=$t.clear,fs=()=>{$t.set(new Date)};var Tl={visitedCount:"gn_ow_ui_vc"},mo=Ae(Tl.visitedCount,0),hs=mo.get,Rl=mo.clear,wl=()=>mo.set(hs()+1),uo=o=>{var t;let e=(t=o.limitations)==null?void 0:t.offerRequirements.requiredPVCount;return e?hs()>=e:!0},Il=(o,e)=>qt(e.lastRewardedAt,{day:e.validityDays}).getTime()<=o.getTime(),_l=()=>{let o=Wt();!o||!Il(new Date,{lastRewardedAt:o,validityDays:30})||(Rl(),gs())},Pl=o=>{uo(o)||wl()},vs=o=>{_l(),Pl(o)};var Cl=({deviceWidthTargeting:o})=>o?ct(window.outerWidth,o):!0,ys={name:"deviceWidthTargeting",updateStatus:b,isPermitted:o=>Cl(o.limitations)};var Ol="gn_ow_vc",Yt=Ae(Ol,0),Ml=Yt.get,xl=Yt.clear,go=()=>Yt.set(Yt.get()+1),Es=o=>{let e=o.limitations.frequencyControl;return!e||e.type!=="pv"||e.frequencyCount===0?!0:Ml()%e.frequencyCount==0},Ll=o=>{Es(o)?xl():go()},Ss={name:"pvFrequency",isPermitted:Es,updateStatus:Ll};var Dl=(o,e)=>{let t=qt(e.lastRewardedAt,{minute:e.validityMinutes});return o.getTime()>=t.getTime()},Fl=o=>{let e=o.limitations.frequencyControl;if(!e||e.type!=="time")return!0;let t=Wt();return t?Dl(new Date,{lastRewardedAt:t,validityMinutes:e.frequencyMinute}):!0},As={name:"timeFrequency",isPermitted:Fl,updateStatus:b};var jt=o=>!!o&&o.length>0,Nl=({locationSetting:o})=>{if(!o)return!0;let{whiteList:e,blackList:t}=o;return jt(t)&&jt(e)?Bl(e,t):jt(t)?Ts(t):jt(e)?bs(e):!0},bs=o=>Rs(o),Ts=o=>!Rs(o),Bl=(o,e)=>bs(o)&&Ts(e),Rs=o=>o.some(e=>new RegExp(e).test(location.href)),ws={name:"location",updateStatus:b,isPermitted:o=>Nl(o.limitations)};var Hl=()=>[Ss,As,ys,ws],Is=o=>{let e=Hl(),t=!0;return e.forEach(r=>{l.log(`Permitter: ${r.name}`,r.isPermitted(o)),t=t&&r.isPermitted(o),r.updateStatus(o)}),t},_s=()=>{go(),fs()};var w={container:"gn-ow-container",dialog:"gn-ow-dialog",button:"gn-ow-button",buttonDisabled:"gn-ow-button-disable",title:"gn-ow-title",description:"gn-ow-description",info:"gn-ow-info",logoContainer:"gn-ow-logo-container",logo:"gn-ow-logo",loadingIndicator:"gn-ow-ad-loading-indicator"},Ul=({title:o,description:e,info:t,button:r,logo:n})=>{let i=n?"flex-end":"center";return[`#${w.container} {
      overflow: hidden;
      position: fixed;
      width: 100%;
      z-index: ${Y.OFFERWALL};
      height: 100%;
      top: 0;
      left: 0;
      background-color: rgba(1,1,1, .5);
      display: flex;
      align-items: center;
      justify-content: center;
    }`,`#${w.dialog} {
      box-sizing: content-box;
      max-width: 400px;
      width: 90%;
      aspect-ratio: 1 / 1;
      background-color: white;
      display: flex;
      align-items: center;
      justify-content: ${i};
      flex-direction: column;
      border-radius: 10px;
      padding: 14px;
      font-family: "MS PGothic", "\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF", "Hiragino Kaku Gothic ProN", "\u30D2\u30E9\u30AE\u30CE\u89D2\u30B4 ProN";
    }`,`#${w.logoContainer} {
      display: flex;
      flex-direction: row;
      justify-content: center;
      margin: 0px;
    }`,`#${w.logo} {
      max-height: 60px;
      min-height: 40px;
    }`,`#${w.title} {
      color: ${o.fontColor};
      font-size: ${o.fontSize}px;
      font-weight: ${o.fontWeight};
      margin: ${bt(20,0)};
    }`,`#${w.description} {
      color: ${e.fontColor};
      font-size: ${e.fontSize}px;
      font-weight: ${e.fontWeight};
      margin: ${bt(16,0)};
    }`,`#${w.info} {
      color: ${t.fontColor};
      font-size: ${t.fontSize}px;
      font-weight: ${t.fontWeight};
      margin: ${bt(14,0)};
    }`,`#${w.button} {
      font-weight: ${r.fontWeight};
      font-size: ${r.fontSize}px;
      line-height: 25px;
      color: #444;
      color: ${r.fontColor};
      width: 100%;
      padding-top: 20px;
      padding-bottom: 20px;
      background-color: ${r.backgroundColor};
      border-radius: 10px;
      border: none;
      box-shadow: none;
      cursor: pointer;
    }`,`#${w.buttonDisabled} {
      font-weight: ${r.fontWeight};
      font-size: ${r.fontSize}px;
      line-height: 25px;
      color: #444;
      color: white;
      width: 100%;
      padding-top: 20px;
      padding-bottom: 20px;
      background-color: #ddd;
      border-radius: 10px;
      border: none;
      box-shadow: none;
      cursor: pointer;
    }`,`.${w.loadingIndicator}::after {
      content: '...';
      display: inline-block;
      animation: ellipsis 1.5s infinite;
      width: 1em;
      text-align: left;
    }`,`.${w.loadingIndicator}::before {
      content: '';
      display: inline-block;
      width: 1em;
    }`,`@keyframes ellipsis {
      0% { content: ''; }
      25% { content: '.'; }
      50% { content: '..'; }
      75% { content: '...'; }
    }`]},kl=(o,e)=>{o.id=w.buttonDisabled,o.textContent=e,o.disabled=!0,o.classList.add(w.loadingIndicator)},Gl=(o,e)=>{o.id=w.button,o.textContent=e,o.disabled=!1,o.classList.remove(w.loadingIndicator)},Vl=o=>{let e="CM\u3092\u53D6\u5F97\u3057\u3066\u3044\u307E\u3059",t=y("button",{id:w.button},o.text);return{button:t,stateChanger:{enable:()=>Gl(t,o.text),disable:()=>kl(t,e)}}},zl=o=>{let e=y("img",{id:w.logo,src:o==null?void 0:o.url});return y("h2",{id:w.logoContainer},e)},ql=o=>{let e=y("div",{id:w.container}),t=y("div",{id:w.dialog}),r=y("h2",{id:w.title},o.title.text),n=y("p",{id:w.description},o.description.text),i=y("p",{id:w.info},o.info.text),s=Vl(o.button);return[...o.logo?[zl(o.logo)]:[],r,n,s.button,i].forEach(d=>t.appendChild(d)),e.appendChild(t),[e,s]},$l=()=>{document.body.classList.remove(se)},Wl=()=>{document.body.classList.add(se)},Ps=o=>{if(o.type==="custom")throw new Error("popup does not support custom layout");let[e,t]=ql(o);document.body.appendChild(e),Tt(),Rt();let r=M(Ul(o));return Wl(),vn(),[()=>{$l(),r.remove(),e.remove()},t]};var Cs=({closePopup:o,viewButtonStateChanger:e})=>({rewarded:()=>{l.log("Offerwall:","User got reward"),_s()},closed:t=>{if(e.enable(),!t.isRewarded)return l.log("Offerwall: ","User closed ads without reward");o()}}),Os=r=>g(void 0,[r],function*({closePopup:o,rewardAdapter:e,viewButtonStateChanger:t}){l.log("Offerwall:","user clicked view ad button."),t.disable();try{yield e.display()}catch(n){o()}});var Kt=(o,e)=>g(void 0,null,function*(){if(vs(o),!uo(o)||!Is(o))return;let[r,{button:n,stateChanger:i}]=Ps(o.popup),s=Cs({divId:o.divId,closePopup:r,viewButtonStateChanger:i}),a=v(u({},o),{listeners:s});e.request(a),n.addEventListener("click",()=>{yn(),Os({closePopup:r,adUnit:o,rewardAdapter:e,viewButtonStateChanger:i})})});var Ms=class{constructor(e=b){this.flushCallback=e;this.globalPrevention=0,this.preventionMap=new Map,this.callee=new Set}addEntries(e){e.filter(t=>!this.preventionMap.has(t)).forEach(t=>this.preventionMap.set(t,0))}execOrReserveCallback(...e){let t=gr(e);if(!t||!t.length)return;let{execTarget:r,restTarget:n}=t.reduce((i,s)=>(this.isPrevented(s)?i.restTarget.push(s):i.execTarget.push(s),i),{execTarget:[],restTarget:[]});this.flushCallback(r),n.forEach(i=>this.callee.add(i))}isPrevented(e){return this.getPrevention(e)>0}getPrevention(e){return this.preventionMap.has(e)?this.preventionMap.get(e)+this.globalPrevention:this.globalPrevention}prevent(e){return e===null?this.preventGlobal():this.preventById(e),{map:this.preventionMap,global:this.globalPrevention}}permit(e){return e===null?this.permitGlobal():this.permitById(e),{map:this.preventionMap,global:this.globalPrevention}}resetPrevention(e){return e!==null?(this.preventionMap.delete(e),this.callee.delete(e)):(this.preventionMap.clear(),this.callee.clear()),{map:this.preventionMap,global:this.globalPrevention}}preventGlobal(){this.globalPrevention++}permitGlobal(){this.globalPrevention--;let e=Array.from(this.callee).filter(t=>this.getPrevention(t)===0);this.execFlushCallback(e)}preventById(e){this.preventionMap.set(e,this.preventionMap.has(e)?this.preventionMap.get(e)+1:1)}permitById(e){if(!this.preventionMap.has(e)){l.log("Refresher","divId:",e,"is not prevented");return}this.preventionMap.set(e,this.preventionMap.get(e)-1),this.getPrevention(e)===0&&this.callee.has(e)&&this.execFlushCallback(e)}execFlushCallback(...e){let t=gr(e);!t.length||(this.flushCallback(t),t.forEach(r=>this.callee.delete(r)))}},xs=Ms;var ge={REFRESHABLE:0,STOPPED:1,STRICTLY_REFRESH:2},fo={ONE_BY_ONE:0,BATCH:1},Ls=class{constructor(e,t,r,n){this.adSlotService=e;this.renderer=t;this.batchRenderer=r;this.events=n;this.name="Refresher",this.preventer=new xs(this.refreshInner.bind(this)),this.repRefStore={},this.refreshFns=[this.refreshOneByOne.bind(this),this.refreshBatch.bind(this)],this.methodType=fo.ONE_BY_ONE}init(){let e=this.adSlotService.getAll();this.preventer.addEntries(e.map(t=>t.divId)),this.__unstable_initRepRefStore(e),this.events.on(p.Refresher.prevent,()=>{this.prevent()},this),this.events.on(p.Refresher.permit,()=>{this.permit()},this),this.events.on(p.init,t=>{this.immediateRefresh(t)},this),this.events.once(p.init,t=>{t.runEnv.useSingleRequest&&this.batchMode()},this),this.events.on(p.Refresher.afterRefresh,()=>{this.events.updateRunEnv({useSingleRequest:!1}),this.singleMode()},this),this.events.on(p.Bidder.requestRefresh,t=>{this.afterBidRefresh(t)},this),this.events.on(p.Analyzer.intervalHit,t=>{this.__unstable_repetitiveRefresh(t)},this),this.events.on(p.Refresher.recovery,t=>{this.adRecoverRefresh(t)},this),window.addEventListener("message",this.__unstable_messageHandler.bind(this))}singleMode(){this.methodType=fo.ONE_BY_ONE,l.log(this.name,"switch single mode")}batchMode(){this.methodType=fo.BATCH,this.events.updateRunEnv({useSingleRequest:!0}),l.log(this.name,"switch batch mode")}refreshInner(e){this.refreshFns[this.methodType](e),this.events.emit(p.Refresher.afterRefresh,t=>e.includes(t.divId))}refreshOneByOne(e){e.forEach(t=>{let r=this.adSlotService.get(t);!r||!r.isReady||this.renderer.render(r)})}refreshBatch(e){let t=e.includes(K)?this.adSlotService.getAll().filter(n=>n.isReady):this.adSlotService.getAll().filter(n=>n.isReady&&!n.isInterstitial);["gam","aladdin"].forEach(n=>{let i=t.filter(s=>{var a;return((a=s.tag)==null?void 0:a.adServer)===n});i.length>0&&(l.log(this.name,"batch-request ads to",n,i.map(s=>s.divId)),this.batchRenderer.render(i,n))})}refresh(e){this.preventer.execOrReserveCallback(e)}immediateRefresh(e){let{runEnv:t,adSlots:r}=e;if(t.useSingleRequest&&r.some(i=>i.canUseHB))return;let n=r.filter(i=>!i.canUseHB).map(i=>i.divId);l.log(this.name,"invoke immediate refresh",n),this.refresh(n)}afterBidRefresh(e){if(!e.adSlots)return;let t=e.adSlots.map(r=>r.divId);l.log(this.name,"invoke afterBid refresh",t),this.refresh(t)}resetRefreshCount(e){var i,s;let t=e.divId,r=this.repRefStore,n=v(u({},r[t]),{permission:ge.REFRESHABLE,count:(s=(i=e.settings.refresh)==null?void 0:i.count)!=null?s:0});this.repRefStore[t]=n,l.log(this.name,"reset refresh count for",t)}adRecoverRefresh(e){e.adSlots.forEach(t=>{let r=t.divId;t.updateRenderParams({targeting:$o}),t.canUseHB?this.events.emit(p.Refresher.requestReBid,n=>n.divId===r):this.refresh([r]),this.resetRefreshCount(t),l.log(this.name,`refresh for "${r}" with recovery`)})}__unstable_repetitiveRefresh(e){e.adSlots.forEach(t=>{var s;let r=t.divId,n=this.repRefStore[r];if(!n||n.permission===ge.STOPPED||n.count<=0)return;l.log(this.name,"request refresh for",r,"current permission type:",n.permission,"remaining refreshcount:",n.count),t.updateRenderParams({targeting:qo});let i=(s=t.settings.aladdinZoneInfo)==null?void 0:s.id;i?ns(i):l.errorLog(`zoneId for ${t.divId} is null.`),t.canUseHB?this.events.emit(p.Refresher.requestReBid,a=>a.divId===r):this.refresh([t.divId]),--this.repRefStore[r].count,this.repRefStore[r].permission=ge.REFRESHABLE})}__unstable_initRepRefStore(e){this.repRefStore=e.reduce((t,r)=>{var n,i;return r.isRefreshable&&(t[r.divId]={permission:ge.REFRESHABLE,count:(i=(n=r.settings.refresh)==null?void 0:n.count)!=null?i:Vo}),t},{}),l.log(this.name,"reserve repetitive refresh",this.repRefStore)}__unstable_stopRepRef(e){let t=this.repRefStore;if(!t[e])return t;let r=v(u({},t),{[e]:v(u({},t[e]),{permission:ge.STOPPED})});return this.repRefStore=r,l.log(this.name,"stopping repetitive refresh for:",e),this.repRefStore}enableRepRef(e){let t=this.repRefStore;if(!t[e])return t;let r=v(u({},t),{[e]:v(u({},t[e]),{permission:ge.STRICTLY_REFRESH})});return this.repRefStore=r,l.log(this.name,"enabling repetitive refresh for:",e),this.repRefStore}__unstable_messageHandler(e){var r;let{data:t}=e;if(!!(t==null?void 0:t.slotDiv)&&((r=this.repRefStore[t.slotDiv])==null?void 0:r.permission)!==ge.STRICTLY_REFRESH){if((t==null?void 0:t.type)===he){this.__unstable_stopRepRef(t.slotDiv);return}if((t==null?void 0:t.type)===Yo){this.enableRepRef(t.slotDiv);return}}}resetPrevention(e){let t=this.preventer.resetPrevention(e!=null?e:null);l.log(this.name,"reset prevention for",e!=null?e:"global","count (global)",t.global)}prevent(e){let t=this.preventer.prevent(e!=null?e:null);l.log(this.name,"prevent invoked for",e!=null?e:"global","count",e?t.map.get(e):t.global)}permit(e){let t=this.preventer.permit(e!=null?e:null);l.log(this.name,"permit invoked for",e!=null?e:"global","count",e?t.map.get(e):t.global)}},Ds=Ls;var Yl=()=>g(void 0,null,function*(){var r;let o=yield(r=window.navigator.cookieDeprecationLabel)==null?void 0:r.getValue();return!["treatment_1.1","treatment_1.2","treatment_1.3","control_2"].some(n=>!!(o==null?void 0:o.endsWith(n)))}),ho=class{constructor(e,t){this.gamSlotProtector=e;this.events=t;this.is3rdPartyAvailable=Yl()}willNotifyNoAd(e){E.addEventListenerOnce("slotRenderEnded",t=>!t.isEmpty||t.slot.getSlotElementId()!==e.divId?!1:(this.events.emit(p.GamRequester.NoAd,r=>r.divId===e.divId),!0))}apply3rdPartyKeyValue(e){return g(this,null,function*(){let r={"cpt-3pc":(yield this.is3rdPartyAvailable)?"1":"0"};e.updateRenderParams({targeting:r})})}request(e){return g(this,null,function*(){let t=[];for(let r of e){let n=r.isInterstitial?this.gamSlotProtector.safeDefineGamInterstitialSlot(r):this.gamSlotProtector.pickOrRedefineSlot(r);!n||(yield this.apply3rdPartyKeyValue(r),n.updateTargetingFromMap(r.renderParams.targeting),t.push(n),r.isInterstitial&&setTimeout(()=>this.events.emit(p.Requester.requestInterstitial),0),this.willNotifyNoAd(r))}t.length!==0&&this.gamSlotProtector.safeRequestAds(t)})}};var vo=class{constructor(){this.cmd=[]}init(){this.cmd=[]}execImmediately(e){e()}execCmd(){!Array.isArray(this.cmd)||(this.cmd.forEach(e=>e()),this.cmd={push:this.execImmediately,unshift:this.execImmediately})}push(e){this.cmd.push(e)}unshift(e){this.cmd.unshift(e)}};var yo={iframe:"gn-interstitial-iframe",closeButton:"gn_interstitial_close_icon",adContrainer:"gn_interstitial_area"},jl=o=>{let e=o.target;return(e==null?void 0:e.id)===yo.closeButton},Kl=o=>{document.body.classList.remove(ye),o.style.display="none"},Ql=o=>{document.body.classList.add(ye),o.style.display="block"},Xl=o=>{let e=o.getElementById(yo.adContrainer);!e||(e.style.opacity="1")},Fs=(o,e)=>g(void 0,null,function*(){let t=y("iframe",{id:yo.iframe,scrolling:"no"});Ln(t,{width:"100%",height:"100%",position:"fixed",top:"0",left:"0",border:"0",zIndex:Y.INTERSTITIAL,display:"none"});let r=()=>{var a;Kl(t),(a=e==null?void 0:e.onclose)==null||a.call(e)};document.body.prepend(t);let n=t.contentDocument;Xe(n,o).then(()=>{n.addEventListener("click",a=>{!jl(a)||r()}),Xl(n)}),l.log("direct delivery AladdinInterstitial");let i=()=>!n.getElementById("gn_interstitial_area"),s=()=>{Ql(t),Tt(),Rt(),En()};if(!i()){s();return}if(yield Pi(700),!i()){s();return}r(),Sn(),l.errorLog("Aladdin interstitial is NoAd")});var Ns=o=>{var e,t,r,n,i;return{loaded:(e=o.loaded)!=null?e:b,completed:(t=o.completed)!=null?t:b,timeout:(r=o.timeout)!=null?r:b,rewarded:(n=o.rewarded)!=null?n:b,closed:(i=o.closed)!=null?i:b}},Bs={rewarded:b,loaded:b,completed:b,closed:b,timeout:b},Hs=(o,e)=>Object.keys(Bs).reduce((t,r)=>{let n=r,s=(a=>a==="timeout"?d=>{var c,f;(c=o[a])==null||c.call(o,d),(f=e[a])==null||f.call(e,d)}:a==="closed"?d=>{var c,f;(c=o[a])==null||c.call(o,d),(f=e[a])==null||f.call(e,d)}:()=>{var d,c;(d=o[a])==null||d.call(o),(c=e[a])==null||c.call(e)})(n);return v(u({},t),{[n]:s})},Bs);var Us=o=>o.format==="offerwall";var ks=o=>g(void 0,null,function*(){var t;let e=new et;if(Us(o))Kt(o,e);else{let r=Ns((t=o.listeners)!=null?t:{});yield e.request(v(u({},o),{listeners:r})),e.display()}});var Jl={DISPLAY:"gn_reward_display"},Zl={INSTRUCTION_RECIEVED:"gn_reward_ack",CLOSED:"gn_reward_ad_closed"},Eo=u(u({},Jl),Zl),ed=o=>typeof o=="string"||typeof o.divId!="string"?!1:o.type===Eo.DISPLAY,td=o=>o?!!o.top:!1,Gs=new Map,So=()=>Gs,Vs=(o,e,t)=>{for(let[n,i]of So().entries())i.postMessage({type:o,divId:e,payload:t},n);if(!So().size){l.log(`[cpt reward messeging API]: msg type: ${o}, target origin not defined`);return}let r=Array.from(So().keys());l.log(`[cpt reward messeging API]: post ${o} message to ${r.join(", ")} for divId: ${e}`,t!=null?t:"")},rd=o=>{Vs(Eo.INSTRUCTION_RECIEVED,o)},zs=o=>{window.addEventListener("message",e=>{let t=e.data,r=e.source;if(!ed(t)||!td(r))return;let n=o.get(t.divId);if(!n){l.errorLog("[cpt reward messeging API]: reward adUnit not defined");return}Gs.set(e.origin,r),l.log("[cpt reward messeging API]: recieve message from ",e.origin),rd(t.divId),ks(n)})},Ao=(o,e)=>{Vs(Eo.CLOSED,o,e)};var od=o=>{let e=new Promise(r=>{window.gnsrwdmod=window.gnsrwdmod||{cmd:[]},window.gnsrwdmod.cmd=window.gnsrwdmod.cmd||[],window.gnsrwdmod.cmd.push(()=>r(window.gnsrwdmod))}),t=new Promise((r,n)=>{setTimeout(()=>{document.querySelector("script[src$='gnsrwdmod.js']")?n(new Error("timeout gnsrwdmod.js")):r(null)},o)});return Promise.race([e,t])},et=class{constructor(){this.name="RewardAdapter",this.waitRewardLib=od(2100),this.loadAllCmd=new vo}request(e){return g(this,null,function*(){let t=yield this.waitRewardLib;t!==null&&(this.clearProfiles(t),this.addProfile(t,e),this.loadAll(t,e))})}loadAll(e,t){let r=this.buildListenersWithRetryAndFillNoAd(e,t);e.loadAllParallely(r),this.loadAllCmd.execCmd(),l.log(this.name,"set event listeners",r)}display(){return g(this,null,function*(){if(this.displayFillerAdAndGiveReward){this.displayFillerAdAndGiveReward();return}let e=yield this.waitRewardLib;e!==null&&this.loadAllCmd.push(()=>{e.display(),this.hasDisplayCalled=!0,l.log(this.name,"displayed reward ads")})})}buildListenersWithRetryAndFillNoAd(e,t){return Hs(t.listeners,{closed:r=>{Ao(t.divId,r),!r.isRewarded&&(this.loadAllCmd.init(),this.loadAll(e,t),this.hasDisplayCalled=!1)},timeout:r=>{An(r.responseReceivedCount);let n=()=>{let i=()=>{var a,d;let s={isRewarded:!0};(d=(a=t.listeners)==null?void 0:a.closed)==null||d.call(a,s),Ao(t.divId,s)};Fs(t.fillerZoneId,{onclose:i}).catch(b).finally(()=>{t.listeners.rewarded()})};if(this.hasDisplayCalled){n();return}this.displayFillerAdAndGiveReward=n}})}addProfile(e,t){let r=this.buildProfile(t);r.forEach(n=>e.addProfile(n)),l.log(this.name,"added profile",r)}clearProfiles(e){e.clearProfiles()}createAdTag(e){return e.adserver==="google"?e.childGamId?`/${e.gamId},${e.childGamId}/${e.code}`:`/${e.gamId}/${e.code}`:String(e.aladdinZoneId)}buildProfile(e){let t=1750;return e.profiles.map(n=>({adserver:n.adserver,adtag:this.createAdTag(n),settings:{timeout:t}}))}};var bo=class{constructor(){this.name="RewardAdSlotService",this.store=new Map}addAdUnits(e){e.filter(r=>!this.store.has(r.divId)).forEach(r=>{this.store.set(r.divId,r)}),l.log(this.name,"add adUnits",e)}get(e){let t=this.store.get(e);return t||(l.log(this.name,`did not found adUnit for id ${e}`),void 0)}};var To=class{constructor(e,t){this.adSlotService=new Ft,this.adSlotService=new Ft,this.gamSlotProtector=new Br,this.modManager=new us(this.adSlotService),this.renderedAds=new Set;let r=t||{mediaId:0};this.gamSlotProtector.setGamConfig(r),this.modManager.setConfig(r),this.config=r,hn();let n={gam:new ho(this.gamSlotProtector,this.modManager.events),aladdin:new Zr(this.modManager.events)};this.refresher=new Ds(this.adSlotService,new Xr(n),new Jr(n),this.modManager.events),this.recoverer=new bi(this.adSlotService,this.modManager.events),this.passbackService=new Hr(this.adSlotService,this.refresher),this.rewardAdUnitService=new bo,this._cmd=(e==null?void 0:e.cmd)||[],this.cmd=null,this.isRun=!1,this.isPreventFirstRun=!1,this.libLoaded=!0,zs(this.rewardAdUnitService),this.sendLogWhenFirstImpressionOccurs()}chooseUPRBySlotDiv(e){return ai(e,this.adSlotService)}addAdUnits(e){let t=this.adSlotService.registerAdSlots(e);return l.log("adUnits added",t),this}setConfig(e){return this.modManager.setConfig(e),this.gamSlotProtector.setGamConfig(e),this}run(){return g(this,null,function*(){this.isRun||this.isPreventFirstRun||(l.log(`run gnshbrequest v${fe}`),this.isRun=!0,this.refresher.init(),this.recoverer.init(),this.refresher.prevent(),this.modManager.enableMods(),yield this.gamSlotProtector.init(this.adSlotService.getAll()),this.gamSlotProtector.isSingleRequestEnabled&&this.modManager.updateRunEnv({useSingleRequest:!0}),this.modManager.emit(p.init),this.refresher.permit())})}rerun(e=!0,t=3e3){return l.log("rerun"),this.passbackService.rerun(),this.isRun?(this.modManager.emit(p.init),e&&this.modManager.emit(p.reload),Promise.resolve()):new Promise((r,n)=>{let i,s=()=>{if(l.log("retry rerun"),window.cancelAnimationFrame(i),!this.adSlotService.isAdSlotsReady){i=window.requestAnimationFrame(s);return}window.clearTimeout(a),this.isPreventFirstRun=!1,r(this.run())},a=window.setTimeout(()=>{window.cancelAnimationFrame(i),window.clearTimeout(a),n(new Error("rerun timedout"))},t);s()})}removeOverlay(){let e=document.getElementById(C);e==null||e.remove()}preventFirstRun(){this.isPreventFirstRun=!0,l.log("prevent firstrun")}preventDefaultRefresh(e){typeof e!="string"&&typeof e!="undefined"||this.refresher.prevent(e)}permitDefaultRefresh(e){typeof e!="string"&&typeof e!="undefined"||this.refresher.permit(e)}requestSlots(e){return this.gamSlotProtector.requestSlots(e)}insertAdDynamically(e,t){di(this.refresher,e,t)}registerPassback(e){typeof e=="string"&&this.passbackService.registerPassback(e)}applyPassback(e,t,r=!1){this.gamSlotProtector.requestSlots(()=>{this.passbackService.applyPassback(e,t,r)})}debug(e){l.setMode(e)}openExternalDebugger(){l.openExternalDebugger()}closeExternalDebugger(){l.closeExternalDebugger()}forceInternalRequest(){this.gamSlotProtector.forceInternalRequest(),l.log("force Internal Request.")}abortAllSlots(){return this.gamSlotProtector.abortAllSlots()}getSlots(){return this.gamSlotProtector.slots}initCmd(){let e=this._cmd,t=r=>{if(typeof r=="function")try{l.log("gnshbrequest.cmd invoked"),r()}catch(n){l.errorLog("error occured in gnshbrequest.cmd",n)}};if(Array.isArray(e))for(;e.length;)t(e.shift());this._cmd=[],this.cmd={push:t,unshift:t}}addRewardAdUnits(e){return this.rewardAdUnitService.addAdUnits(e),this}permitDefineSlot(e){return typeof e=="string"?(this.adSlotService.permitRegister([e]),this):(this.adSlotService.permitRegister(e),this)}applyThirdPartyTag(e,t){return g(this,null,function*(){let r=window.gnThirdPartySlots;if(!r)return;let n=r.find(i=>i.slotDiv===e);!n||(yield qn(t,n,this.config))})}hideAdsBehind(e){if(Array.isArray(e)){Er(e);return}Er([e])}displayOfferWall(e){Kt(e,new et)}getSlotMap(){return this.adSlotService.getAll().flatMap(e=>{var t;return(t=e.slotMap)!=null?t:[]})}sendLogWhenFirstImpressionOccurs(){T.addMessageListener("CptAdRendered",({data:e})=>{let{divId:t,adServer:r}=e;this.renderedAds.has(t)||(Rn(t,r),this.renderedAds.add(t))})}};(function(o){var e;o.gnshbrequest=((e=o.gnshbrequest)==null?void 0:e.libLoaded)?o.gnshbrequest:new To(o.gnshbrequest,o.__gn_config),o.gnshbrequest.requestSlots(()=>{o.getGnshbrequestSlots=o.gnshbrequest.getSlots.bind(o.gnshbrequest)}),o.gnshbrequest.initCmd()})(window);})();
/**
* @license Apache-2.0
*
* Copyright (c) 2018 The Stdlib Authors.
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*    http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*
* This script is modified by takumi furukawa. Original work is here:
* https://github.com/stdlib-js/random-base-beta/blob/main/lib/beta.js
* The modifications are as follows:
* - change commonjs style to es2015 style
* - use browser's functions for mathematical instead of stdlib's
* - remove unnecessary comments
*/
/**
* @license Apache-2.0
*
* Copyright (c) 2018 The Stdlib Authors.
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*    http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*
* This script is modified by takumi furukawa. Original work is here:
* https://github.com/stdlib-js/random-base-beta/blob/main/lib/sample1.js
* The modifications are as follows:
* - change commonjs style to es2015 style
* - use browser's functions for mathematical instead of stdlib's
* - remove unnecessary comments
*/
/**
* @license Apache-2.0
*
* Copyright (c) 2018 The Stdlib Authors.
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*    http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*
* This script is modified by takumi furukawa. Original work is here:
* https://github.com/stdlib-js/random-base-beta/blob/main/lib/sample2.js
* The modifications are as follows:
* - change commonjs style to es2015 style
* - use browser's functions for mathematical instead of stdlib's
* - remove unnecessary comments
*/
/**
* @license Apache-2.0
*
* Copyright (c) 2018 The Stdlib Authors.
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*    http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*
* This script is modified by takumi furukawa. Original work is here:
* https://github.com/stdlib-js/random-base-beta/blob/main/lib/sample3.js
* The modifications are as follows:
* - change commonjs style to es2015 style
* - use browser's functions for mathematical instead of stdlib's
* - remove unnecessary comments
*/
/**
* @license Apache-2.0
*
* Copyright (c) 2021 The Stdlib Authors.
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*    http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* 
* This script is modified by takumi furukawa. Original work is here:
* https://github.com/stdlib-js/random-base-beta/blob/main/lib/standard_gamma.js
* The modifications are as follows:
* - change commonjs style to es2015 style
* - use browser's functions for mathematical instead of stdlib's
* - remove unnecessary comments
*/
